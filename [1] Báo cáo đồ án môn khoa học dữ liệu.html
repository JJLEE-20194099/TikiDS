<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Báo cáo đồ án môn khoa học dữ liệu - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{padding-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important;position:relative}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p:last-child{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{text-align:center;background-color:inherit;border-radius:0;white-space:inherit;overflow:visible}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p:last-child,.markdown-body .alert>ul:last-child{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.figma{display:table;position:relative;width:100%;padding-bottom:56.25%}.figma iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%;border:1px solid #eee}.MJX_Assistive_MathML{display:none}#MathJax_Message{z-index:1000!important}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc.both-mode{margin-left:8px}.ui-toc.both-mode .ui-toc-label{height:40px;padding:10px 4px;border-top-left-radius:0;border-bottom-left-radius:0}.ui-toc-label{background-color:#e6e6e6;border:none;color:#868686;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:20px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child>ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:50%;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-more-info{color:#888;cursor:pointer;vertical-align:middle}.ui-more-info .fa{font-size:16px}.ui-connectedGithub,.ui-published-note{color:#888}.ui-connectedGithub{line-height:23px;white-space:nowrap}.ui-connectedGithub a.file-path{color:#888;text-decoration:none;padding-left:22px}.ui-connectedGithub a.file-path:active,.ui-connectedGithub a.file-path:hover{color:#888;text-decoration:underline}.ui-connectedGithub .fa{font-size:20px}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}.selectable{-webkit-user-select:text;-o-user-select:text;user-select:text}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}.site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;letter-spacing:.025em;font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled comment-inner" data-hard-breaks="true"><h1 id="Báo-cáo-đồ-án-môn-khoa-học-dữ-liệu" data-id="Báo-cáo-đồ-án-môn-khoa-học-dữ-liệu"><a class="anchor hidden-xs" href="#Báo-cáo-đồ-án-môn-khoa-học-dữ-liệu" title="Báo-cáo-đồ-án-môn-khoa-học-dữ-liệu"><span class="octicon octicon-link"></span></a><span>Báo cáo đồ án môn khoa học dữ liệu</span></h1><ul>
<li>
<p><a href="#"><span>Tự đánh giá project</span></a></p>
</li>
<li>
<p><a href="#khoa-h-c-d--li-u"><span>Về chúng tôi</span></a></p>
<ul>
<li><a href="#tha-nh-vi-n-nho-m"><span>Thành viên của nhóm</span></a></li>
<li><a href="#ph-n-c-ng-c-ng-vi--c"><span>Phân công công việc</span></a></li>
</ul>
</li>
<li>
<p><a href="#%C4%90%C3%AA%CC%80-ta%CC%80i"><span>Đề tài</span></a></p>
</li>
<li>
<p><a href="#thu-th-p-d--li-u"><span>Thu thập dữ liệu</span></a></p>
</li>
<li>
<p><a href="#tiki-datasets"><span>Tích hợp dữ liệu</span></a></p>
</li>
<li>
<p><a href="#tiki-datasets"><span>Làm sách và tiền xử lý dữ liệu</span></a></p>
</li>
<li>
<p><a href="#tiki-datasets"><span>Tiki datasets</span></a></p>
</li>
<li>
<p><a href="#kha-m-pha--d---li--u"><span>Khám phá dữ liệu</span></a></p>
</li>
<li>
<p><a href="#"><span>Một số khái niệm và độ đo cần thiết trong project</span></a></p>
<ul>
<li><a href="#"><span>SIA</span></a></li>
<li><a href="#"><span>MAE</span></a></li>
<li><a href="#"><span>MSE</span></a></li>
<li><a href="#"><span>RMSE</span></a></li>
<li><a href="#"><span>Confusion Matrix</span></a></li>
<li><a href="#"><span>Precision và Recall</span></a></li>
</ul>
</li>
<li>
<p><a href="#Sold-Quantity-Prediction-Recommend"><span>Sold Quantity Prediction And Recommend These Items To User</span></a></p>
<ul>
<li><a href="#random-forest-regression"><span>Random Forest Regression</span></a></li>
<li><a href="#linear-regression"><span>Linear Regression</span></a></li>
<li><a href="#neural-network-regression"><span>Neural Network Regression</span></a></li>
</ul>
</li>
<li>
<p><a href="#"><span>Rating Prediction</span></a></p>
<ul>
<li><a href="#"><span>Matrix Factorization</span></a></li>
<li><a href="#"><span>Content-Based</span></a></li>
</ul>
</li>
<li>
<p><a href="#neural-network"><span>Áp dụng mạng neural cải thiện kết quả dự đoán rating</span></a></p>
<ul>
<li><a href="#tiki-product-image-classification"><span>GMF</span></a></li>
<li><a href="#analyzing-user-behaviours"><span>MLP</span></a></li>
<li><a href="#analyzing-user-behaviours"><span>NeuMF</span></a></li>
</ul>
</li>
<li>
<p><a href="#"><span>Bài toán hệ gợi ý</span></a></p>
<ul>
<li><a href="#"><span>Yêu cầu của bài toán</span></a></li>
<li><a href="#"><span>Phương pháp sử dụng</span></a></li>
<li><a href="#"><span>Chi tiết cài đặt</span></a></li>
<li><a href="#"><span>Thử nghiệm</span></a></li>
<li><a href="#"><span>Một vài Case Study</span></a></li>
</ul>
</li>
</ul><h2 id="Tự-đánh-giá-project" data-id="Tự-đánh-giá-project"><a class="anchor hidden-xs" href="#Tự-đánh-giá-project" title="Tự-đánh-giá-project"><span class="octicon octicon-link"></span></a><span>Tự đánh giá project</span></h2><table>
<thead>
<tr>
<th><span>Nội dung</span></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>Thu thập dữ liệu bằng cách sử dụng API</span></td>
<td><span>Hoàn thành</span></td>
</tr>
<tr>
<td><span>Tích hợp dữ liệu</span></td>
<td><span>Hoàn thành</span></td>
</tr>
<tr>
<td><span>Làm sạch và tiền xử lý dữ liệu, xây dựng bộ datasets</span></td>
<td><span>Hoàn thành</span></td>
</tr>
<tr>
<td><span>Phân tích và khám phá dữ liệu sản phẩm tiki</span></td>
<td><span>Đang hoàn thiện</span></td>
</tr>
<tr>
<td><span>Phân tích sự ảnh hưởng của các thuộc tính lên người dùng</span></td>
<td><span>Hoàn thành</span></td>
</tr>
<tr>
<td><span>Sử dụng 2 mô hình Content Based và Matrix Factorization đơn giản cho bài toán dự đoán rating</span></td>
<td><span>Hoàn thành</span></td>
</tr>
<tr>
<td><span>Cái thiện kết quả dự đoán rating bằng cách sử dụng mạng neural nhân tạo</span></td>
<td><span>Hoàn thành</span></td>
</tr>
<tr>
<td><span>Hệ gợi ý</span></td>
<td><span>Hoàn thành</span></td>
</tr>
</tbody>
</table><p><strong><span>Kết quả:</span></strong><span> Nhóm đã có những góc nhìn 1 cách tổng quan về các phương pháp dự đoán rating và từ đó liên hệ qua bài toán gợi ý sản phẩm cho người dùng, đống thời cũng phân tích xem những yếu tố gì ảnh hưởng tối lượng mua của 1 sản phẩm.</span></p><h2 id="Về-chúng-tôi" data-id="Về-chúng-tôi"><a class="anchor hidden-xs" href="#Về-chúng-tôi" title="Về-chúng-tôi"><span class="octicon octicon-link"></span></a><span>Về chúng tôi</span></h2><h3 id="Thành-viên-nhóm" data-id="Thành-viên-nhóm"><a class="anchor hidden-xs" href="#Thành-viên-nhóm" title="Thành-viên-nhóm"><span class="octicon octicon-link"></span></a><span>Thành viên nhóm</span></h3><table>
<thead>
<tr>
<th><span>Họ &amp; tên</span></th>
<th><span>MSSV</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>Lê Thành Long</span></td>
<td><span>20194099</span></td>
</tr>
<tr>
<td><span>Lê Đại Thắng</span></td>
<td><span>20194166</span></td>
</tr>
<tr>
<td><span>Ninh Văn Nghĩa</span></td>
<td><span>20190060</span></td>
</tr>
</tbody>
</table><h3 id="Phân-công-công-việc" data-id="Phân-công-công-việc"><a class="anchor hidden-xs" href="#Phân-công-công-việc" title="Phân-công-công-việc"><span class="octicon octicon-link"></span></a><span>Phân công công việc</span></h3><table>
<thead>
<tr>
<th><span>Họ &amp; tên</span></th>
<th><span>Nội dung công việc</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>Lê Thành Long</span></td>
<td><span>Crawl data từ trang </span><a href="https://tiki.vn/" target="_blank" rel="noopener"><span>https://tiki.vn/</span></a><span>, phân tích sự ảnh hưởng của 1 số thuộc tính lên hành vi của người dùng và cài đặt 1 số mô hình cho bài toán dự đoán rating</span></td>
</tr>
<tr>
<td><span>Lê Đại Thắng</span></td>
<td><span>Tìm hiểu và cài đặt, áp dụng các mô hình neural network cho bài toán gợi ý sản phẩm cho người dùng</span></td>
</tr>
<tr>
<td><span>Ninh Văn Nghĩa</span></td>
<td><span>Làm sạch, tích hợp, tiền xử lý dữ liệu và khám phá, visualize dữ liệu và làm slide</span></td>
</tr>
<tr>
<td><span>Cả nhóm</span></td>
<td><span>Làm báo cáo đồ án môn học</span></td>
</tr>
</tbody>
</table><h2 id="Đề-tài" data-id="Đề-tài"><a class="anchor hidden-xs" href="#Đề-tài" title="Đề-tài"><span class="octicon octicon-link"></span></a><span>Đề tài</span></h2><p><em><strong><span>Phân tích hành vi người dùng trong các trang thương mại điện tử</span></strong></em><br>
<span>Củ thể: </span><em><strong><span>dự đoán rating</span></strong></em><span> của người dùng lên các sản phẩm. Từ đó liên quan đến bài toán </span><em><strong><span>gợi ý sản phẩm</span></strong></em><span> cho người dùng, phân tích yếu tố ảnh hưởng tới </span><em><strong><span>lượng mua sản phẩm</span></strong></em><span> của người dùng, </span><em><strong><span>phân tích cảm xúc</span></strong></em><span> dựa vào bình luận của người dùng</span></p><h2 id="Thu-thập-dữ-liệu" data-id="Thu-thập-dữ-liệu"><a class="anchor hidden-xs" href="#Thu-thập-dữ-liệu" title="Thu-thập-dữ-liệu"><span class="octicon octicon-link"></span></a><span>Thu thập dữ liệu:</span></h2><p><span>Nhóm chúng tôi đã thu thập dữ liệu từ trang thương mại nổi tiếng </span><a href="https://tiki.vn/" target="_blank" rel="noopener"><span>https://tiki.vn/</span></a><span> mặc dù trên mạng đã có rất nhiều bộ data về thương mại điện tử  tuy nhiên bộ datasets của nhóm chúng tôi rất dồi dào về các thông tin chi tiết sản pha và thông tin rating và đặc biệt các sản phẩm trên bộ dataset của nhóm chúng tôi toàn là các sản phẩm mới mới đồng nghĩa là các review ở các bộ phim này cũng là gần đây.</span></p><p><em><strong><span>Thư viện để thu thập dữ liệu là BeautifulSoup và thu thập dữ liệu bằng cách call API của tiki</span></strong></em></p><h2 id="Tích-hợp-dữ-liệu" data-id="Tích-hợp-dữ-liệu"><a class="anchor hidden-xs" href="#Tích-hợp-dữ-liệu" title="Tích-hợp-dữ-liệu"><span class="octicon octicon-link"></span></a><span>Tích hợp dữ liệu</span></h2><p><span>Sau khi crawl data về ta có được thông tin chi tiết, thông tin về id, thông tin tổng quan của các sản phẫm thuộc vào từng category, khi đó nhóm chúng tôi tích hơp các thư mục category lại và tạo thành các file data lớn hơn: </span><em><strong><span>intergrated_data/item/detail_list.csv</span></strong></em><span>, </span><em><strong><span>intergrated_data/item/overall_list.csv</span></strong></em><span> và </span><em><strong><span>intergrated_data/rating/rating_list.csv</span></strong></em></p><h2 id="Làm-sạch-và-tiền-xử-lý-dữ-liệu" data-id="Làm-sạch-và-tiền-xử-lý-dữ-liệu"><a class="anchor hidden-xs" href="#Làm-sạch-và-tiền-xử-lý-dữ-liệu" title="Làm-sạch-và-tiền-xử-lý-dữ-liệu"><span class="octicon octicon-link"></span></a><span>Làm sạch và tiền xử lý dữ liệu</span></h2><p><em><strong><span>Các bước làm sạch và tiền xử lý dữ liệu:</span></strong></em></p><ul>
<li><span>Loại bỏ các hàng trùng nhau cho tất cả các file</span></li>
<li><span>Loại bỏ các hàng trong detail_list.csv có trường price &lt;= 0 và lowercase các trường là string</span></li>
<li><span>Tạo ra các cột tương ứng với mỗi cột là 1 category, giá trị của hàng i và tại cột ấy sẽ là 1 nếu sản phẩm i thuộc vào category đó và là 0 nếu ngược lại</span></li>
<li><span>Loại bỏ tất cả người dùng có lịch sử tường tác &lt; 10, thay vào đó ta sẽ suggest cho những người này các sản phẩm nổi bật</span></li>
<li><span>Rescale lại rating của người dùng đối với 1 số mô hình trong project, </span><em><strong><span>củ thể</span></strong></em><span>, nhóm chúng tối gộp 1, 2 thành 1 rating là 1 và rating 3, 4, 5 sẽ trở thành 2, 3, 4. Kết quả sau khi dự đoán sẽ cộng thêm 1.</span></li>
</ul><h2 id="TIKI-datasets" data-id="TIKI-datasets"><a class="anchor hidden-xs" href="#TIKI-datasets" title="TIKI-datasets"><span class="octicon octicon-link"></span></a><span>TIKI datasets</span></h2><p><span>Gồm 4 bộ chính item/detail_list.csv, item/overall_list.csv và rating/rating_list.csv với ý nghĩa của các bộ dữ liệu lần lượt là thông tin chi tiết của sản phẩm, các thông số tổng quan về sản phẩm  và thông tin bình luận đối với sản phẩm.</span></p><p><strong><span>Chú ý:</span></strong><span> Nhóm chúng tôi đã chia các file csv trên thành </span><em><strong><span>5-fold</span></strong></em><span> và tính toán kết quả triung bình của 5 fold này để làm kết quả chính</span></p><h2 id="Khám-phá-dữ-liệu" data-id="Khám-phá-dữ-liệu"><a class="anchor hidden-xs" href="#Khám-phá-dữ-liệu" title="Khám-phá-dữ-liệu"><span class="octicon octicon-link"></span></a><span>Khám phá dữ liệu</span></h2><h2 id="Một-số-khái-niệm-và-độ-đo-cần-thiết-trong-project" data-id="Một-số-khái-niệm-và-độ-đo-cần-thiết-trong-project"><a class="anchor hidden-xs" href="#Một-số-khái-niệm-và-độ-đo-cần-thiết-trong-project" title="Một-số-khái-niệm-và-độ-đo-cần-thiết-trong-project"><span class="octicon octicon-link"></span></a><span>Một số khái niệm và độ đo cần thiết trong project</span></h2><h3 id="SIA---Soft-Interval-Accuracy" data-id="SIA---Soft-Interval-Accuracy"><a class="anchor hidden-xs" href="#SIA---Soft-Interval-Accuracy" title="SIA---Soft-Interval-Accuracy"><span class="octicon octicon-link"></span></a><span>SIA - Soft Interval Accuracy</span></h3><p><span>Một dự đoán được gói là đúng nói chênh lệch giữa dự đoán và thực tế &lt;= siêu tham số epsilon:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-186-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>y</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>&amp;lt;=</mo><mi>e</mi><mi>p</mi><mi>s</mi></math>" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-4288" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4289" class="mjx-mrow"><span id="MJXc-Node-4290" class="mjx-texatom"><span id="MJXc-Node-4291" class="mjx-mrow"><span id="MJXc-Node-4292" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">|</span></span></span></span><span id="MJXc-Node-4293" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-4294" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.501em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4295" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span></span></span><span id="MJXc-Node-4296" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-4297" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-4298" class="mjx-mrow"><span id="MJXc-Node-4299" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.135em;"><span id="MJXc-Node-4303" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-4300" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-4301" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.501em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4302" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span></span></span></span></span></span></span></span><span id="MJXc-Node-4304" class="mjx-texatom"><span id="MJXc-Node-4305" class="mjx-mrow"><span id="MJXc-Node-4306" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">|</span></span></span></span><span id="MJXc-Node-4307" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.39em;">&lt;<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span></span></span><span id="MJXc-Node-4308" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-4309" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span><span id="MJXc-Node-4310" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mover><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>&lt;=</mo><mi>e</mi><mi>p</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-186">|y_i - \hat{y_i}| <= eps</script></span><br>
<span>Và </span><em><strong><span>SIA</span></strong></em><span> sẽ bằng số mẫu đúng trên toàn bộ mẫu</span></p><hr><h3 id="MAE---Mean-Absolute-Error" data-id="MAE---Mean-Absolute-Error"><a class="anchor hidden-xs" href="#MAE---Mean-Absolute-Error" title="MAE---Mean-Absolute-Error"><span class="octicon octicon-link"></span></a><span>MAE - Mean Absolute Error</span></h3><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-187-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mi>A</mi><mi>E</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi></mrow></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>y</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></math>" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-4311" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4312" class="mjx-mrow"><span id="MJXc-Node-4313" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.081em;">M</span></span><span id="MJXc-Node-4314" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.279em;">A</span></span><span id="MJXc-Node-4315" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-4316" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-4317" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.501em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-4318" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.556em;">,</span></span><span id="MJXc-Node-4319" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-4320" class="mjx-mrow"><span id="MJXc-Node-4321" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-4323" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-4322" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.501em; padding-right: 0.006em;">y</span></span></span></span></span></span></span><span id="MJXc-Node-4324" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span><span id="MJXc-Node-4325" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-4326" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.762em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.078em; top: -1.308em;"><span id="MJXc-Node-4327" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.078em; bottom: -0.524em;"><span id="MJXc-Node-4328" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">m</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 0.762em;"></span></span><span class="mjx-vsize" style="height: 1.295em; vertical-align: -0.37em;"></span></span><span id="MJXc-Node-4329" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.372em;"><span id="MJXc-Node-4336" class="mjx-texatom" style=""><span id="MJXc-Node-4337" class="mjx-mrow"><span id="MJXc-Node-4338" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">m</span></span></span></span></span><span class="mjx-op" style="padding-left: 0.046em;"><span id="MJXc-Node-4330" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.501em; padding-bottom: 0.501em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-4331" class="mjx-texatom" style=""><span id="MJXc-Node-4332" class="mjx-mrow"><span id="MJXc-Node-4333" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-4334" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-4335" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-4339" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-4340" class="mjx-mrow"><span id="MJXc-Node-4341" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">|</span></span></span></span><span id="MJXc-Node-4342" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-4343" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.501em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4344" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span></span></span><span id="MJXc-Node-4345" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-4346" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-4347" class="mjx-mrow"><span id="MJXc-Node-4348" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.135em;"><span id="MJXc-Node-4352" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-4349" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-4350" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.501em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4351" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span></span></span></span></span></span></span></span><span id="MJXc-Node-4353" class="mjx-texatom"><span id="MJXc-Node-4354" class="mjx-mrow"><span id="MJXc-Node-4355" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">|</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>A</mi><mi>E</mi><mo stretchy="false">(</mo><mi>y</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>m</mi></mrow></munderover><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mover><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-187">MAE(y, \hat{y}) = \frac{1}{m} \sum\limits_{i = 1}^{m}|y_i - \hat{y_i}|</script></span></p><hr><h3 id="MSE---Mean-Squared-Error" data-id="MSE---Mean-Squared-Error"><a class="anchor hidden-xs" href="#MSE---Mean-Squared-Error" title="MSE---Mean-Squared-Error"><span class="octicon octicon-link"></span></a><span>MSE - Mean Squared Error</span></h3><p><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3657">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3658">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3659">E</span><span class="MJXp-mo" id="MJXp-Span-3660" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3661">y</span><span class="MJXp-mo" id="MJXp-Span-3662" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-3663"><span class="MJXp-munderover" id="MJXp-Span-3664"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3666" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3665">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3667" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3668" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3669" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3670">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3671">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-3672"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3678" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3679">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-3673" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3674" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3675">i</span><span class="MJXp-mo" id="MJXp-Span-3676">=</span><span class="MJXp-mn" id="MJXp-Span-3677">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3680" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3681"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3682" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3683" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3684" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-3685"><span class="MJXp-munderover" id="MJXp-Span-3686"><span><span class="MJXp-over"><span><span class="MJXp-mo" id="MJXp-Span-3690" style="margin-left: 0px; margin-right: 0px;">^</span></span><span><span class="MJXp-msubsup" id="MJXp-Span-3687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3688" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3689" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3691"><span class="MJXp-mo" id="MJXp-Span-3692" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3693" style="vertical-align: 0.5em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-190">MSE(y, \hat{y}) = \frac{1}{m} \sum\limits_{i = 1}^{m}(y_i - \hat{y_i})^2</script></span></p><hr><h3 id="RMSE---Root-Mean-Squared-Error" data-id="RMSE---Root-Mean-Squared-Error"><a class="anchor hidden-xs" href="#RMSE---Root-Mean-Squared-Error" title="RMSE---Root-Mean-Squared-Error"><span class="octicon octicon-link"></span></a><span>RMSE - Root Mean Squared Error</span></h3><p><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3694"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3695">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3696">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3697">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3698">E</span><span class="MJXp-mo" id="MJXp-Span-3699" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3700">y</span><span class="MJXp-mo" id="MJXp-Span-3701" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-3702"><span class="MJXp-munderover" id="MJXp-Span-3703"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3705" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3704">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3706" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3707" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msqrt" id="MJXp-Span-3708"><span class="MJXp-surd"><span class="MJXp-right MJXp-scale5" style="font-size: 326%; margin-top: 0.043em; margin-left: -0.273em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.113em solid;"></span><span class="MJXp-box"><span class="MJXp-mfrac" id="MJXp-Span-3709" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3710">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3711">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-3712"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3718" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3719">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-3713" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3714" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3715">i</span><span class="MJXp-mo" id="MJXp-Span-3716">=</span><span class="MJXp-mn" id="MJXp-Span-3717">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3720" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3721"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3722" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3723" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3724" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-3725"><span class="MJXp-munderover" id="MJXp-Span-3726"><span><span class="MJXp-over"><span><span class="MJXp-mo" id="MJXp-Span-3730" style="margin-left: 0px; margin-right: 0px;">^</span></span><span><span class="MJXp-msubsup" id="MJXp-Span-3727"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3728" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3729" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3731"><span class="MJXp-mo" id="MJXp-Span-3732" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3733" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-191">RMSE(y, \hat{y}) = \sqrt{\frac{1}{m} \sum\limits_{i = 1}^{m}(y_i - \hat{y_i})^2}</script></span></p><hr><h3 id="Confusion-Matrix" data-id="Confusion-Matrix"><a class="anchor hidden-xs" href="#Confusion-Matrix" title="Confusion-Matrix"><span class="octicon octicon-link"></span></a><span>Confusion Matrix</span></h3><p><span>Đặc biệt sử dụng cho các bài toán phân lớp và đây là 1 ma trận vuông có có size là </span><em><strong><span>số lớp * số lớp</span></strong></em><span>.</span></p><p><span>Tại hàng i côt j của ma trận có giá trị thuộc khoản từ </span><em><strong><span>0-1</span></strong></em><span> có ý nghĩa là số lượng mẫu </span><em><strong><span>đáng ra là thuộc lớp i nhưng đã dự đoán thuộc lớp j</span></strong></em></p><hr><h3 id="Precision-và-Recall" data-id="Precision-và-Recall"><a class="anchor hidden-xs" href="#Precision-và-Recall" title="Precision-và-Recall"><span class="octicon octicon-link"></span></a><span>Precision và Recall</span></h3><p><span>Với bài toán phân loại 2 lớp thì:</span></p><ul>
<li><span>Precision là tỷ lệ sô mẫu đoán đúng lớp thứ nhất trên số lượng ta dự đoán thứ 1</span></li>
<li><span>Recall là tỷ lệ số mẫu đoán đúng lớp thứ nhất trên số lượng mẫu thực sự thuộc lớp thứ 1</span></li>
</ul><p><em><strong><span>Chú ý:</span></strong></em></p><ul>
<li><span>Precision cao nghĩa là xác suất tìm được các điểm đúng là cao</span></li>
<li><span>Recall cao nghĩa là xác suất mình bỏ sót các điểm đúng là thấp</span></li>
</ul><h2 id="Sold-Prediction-And-User-Behaviour-Based-On-Item’s-Features" data-id="Sold-Prediction-And-User-Behaviour-Based-On-Item’s-Features"><a class="anchor hidden-xs" href="#Sold-Prediction-And-User-Behaviour-Based-On-Item’s-Features" title="Sold-Prediction-And-User-Behaviour-Based-On-Item’s-Features"><span class="octicon octicon-link"></span></a><span>Sold Prediction And User Behaviour Based On Item’s Features</span></h2><p><span>Metrics đánh giá mà nhóm sử dụng: </span><em><strong><span>Mean Absolute Error (MAE)</span></strong></em><span> hoặc </span><em><strong><span>Soft Interval Accuracy (SIA)</span></strong></em><br>
<span>Các features sử dụng cho việc dự đoán:</span></p><table>
<thead>
<tr>
<th><span>Feature name</span></th>
<th><span>Type</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>category</span></td>
<td><span>categorical</span></td>
</tr>
<tr>
<td><span>price</span></td>
<td><span>numerical</span></td>
</tr>
<tr>
<td><span>avg_rating</span></td>
<td><span>numerical</span></td>
</tr>
<tr>
<td><span>n_rate_5</span></td>
<td><span>numerical</span></td>
</tr>
<tr>
<td><span>n_rate_4</span></td>
<td><span>numerical</span></td>
</tr>
<tr>
<td><span>n_rate_3</span></td>
<td><span>numerical</span></td>
</tr>
<tr>
<td><span>n_rate_2</span></td>
<td><span>numerical</span></td>
</tr>
<tr>
<td><span>n_rate_1</span></td>
<td><span>numerical</span></td>
</tr>
<tr>
<td><span>rate_with_img</span></td>
<td><span>numerical</span></td>
</tr>
<tr>
<td><span>discount</span></td>
<td><span>numerical</span></td>
</tr>
<tr>
<td><span>discount_rate</span></td>
<td><span>numerical</span></td>
</tr>
<tr>
<td><span>n_reviews</span></td>
<td><span>numerical</span></td>
</tr>
</tbody>
</table><p><span>Ta sẽ phân chia dữ liệu thành các tập </span><code>train - validation - test</code><span> set theo tỉ lệ: </span><code>60% - 20% - 20%</code></p><h3 id="Random-Forest-Regression" data-id="Random-Forest-Regression"><a class="anchor hidden-xs" href="#Random-Forest-Regression" title="Random-Forest-Regression"><span class="octicon octicon-link"></span></a><span>Random Forest Regression</span></h3><h4 id="Dự-đoán-sử-dụng-toàn-bộ-features-one-hot--numeric" data-id="Dự-đoán-sử-dụng-toàn-bộ-features-one-hot--numeric"><a class="anchor hidden-xs" href="#Dự-đoán-sử-dụng-toàn-bộ-features-one-hot--numeric" title="Dự-đoán-sử-dụng-toàn-bộ-features-one-hot--numeric"><span class="octicon octicon-link"></span></a><span>Dự đoán sử dụng toàn bộ features (one hot + numeric)</span></h4><p><span>Kết quả:</span></p><table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>162.19769</span></td>
</tr>
<tr>
<td><span>val</span></td>
<td><span>377.55629</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>366.07174</span></td>
</tr>
</tbody>
</table><p><em><strong><span>Ghi chú</span></strong></em><span>: do kết quả dự đoán có thể lên đến đơn vị nghìn (lượt bán), để dễ giải thích, ta sẽ sử dụng độ đo </span><code>MAE</code><span> (thay vì </span><code>MSE</code><span> như thông thường). Do đó ta có thể đánh giá </span><code>MAE</code><span> trên tập test ~366 có nghĩa là mô hình dự đoán trung bình sai số khoảng 366 cho một sản phẩm trong tập test.</span></p><p><span>Bây giờ ta sẽ xét </span><code>SIA</code><span> metric.</span></p><ul>
<li>
<p><span>Với </span><code>epsilon = 1000</code><span> (cho phép sai số dự đoán lên đến 1k lượt bán):</span></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>SIA-1000</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.97237</span></td>
</tr>
<tr>
<td><span>val</span></td>
<td><span>0.92814</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.93728</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><code>epsilon = 500</code><span> (cho phép sai số dự đoán lên đến 500 lượt bán):</span></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>SIA-500</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.94480</span></td>
</tr>
<tr>
<td><span>val</span></td>
<td><span>0.87425</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.88197</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><code>epsilon = 200</code><span> (cho phép sai số dự đoán lên đến 200 lượt bán):</span></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>SIA-200</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.88470</span></td>
</tr>
<tr>
<td><span>val</span></td>
<td><span>0.78389</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.78114</span></td>
</tr>
</tbody>
</table>
</li>
</ul><p><em><strong><span>Nhận xét</span></strong></em><span>: ta thấy mô hình đạt được độ chính xác khá tốt. Hiệu năng trên tập </span><code>val</code><span> và </span><code>test</code><span> xấp xỉ nhau.</span></p><h3 id="Linear-Regression" data-id="Linear-Regression"><a class="anchor hidden-xs" href="#Linear-Regression" title="Linear-Regression"><span class="octicon octicon-link"></span></a><span>Linear Regression</span></h3><hr><h4 id="Chỉ-sử-dụng-các-numerical-features" data-id="Chỉ-sử-dụng-các-numerical-features"><a class="anchor hidden-xs" href="#Chỉ-sử-dụng-các-numerical-features" title="Chỉ-sử-dụng-các-numerical-features"><span class="octicon octicon-link"></span></a><span>Chỉ sử dụng các numerical features:</span></h4><p><code>price, avg_rating, n_reviews, discount, discount_rate</code><br>
<span>(Bỏ đi </span><code>category</code><span>)</span></p><p><span>Kết quả:</span></p><table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>SIA-1000</span></th>
<th><span>SIA-500</span></th>
<th><span>SIA-200</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>694.18673</span></td>
<td><span>0.89600</span></td>
<td><span>0.78934</span></td>
<td><span>0.50681</span></td>
</tr>
<tr>
<td><span>val</span></td>
<td><span>615.25603</span></td>
<td><span>0.89222</span></td>
<td><span>0.79205</span></td>
<td><span>0.50599</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>558.55912</span></td>
<td><span>0.90026</span></td>
<td><span>0.79486</span></td>
<td><span>0.50675</span></td>
</tr>
</tbody>
</table><p><em><strong><span>Nhận xét</span></strong></em><span>: Ta thấy mô hình Linear Regression có </span><code>SIA</code><span> thấp hơn so với khi sử dụng Random Forest khá nhiều. Hơn nữa, ta thấy mô hình có </span><code>MAE</code><span> trên tập </span><code>val</code><span> và tập </span><code>test</code><span> cao bất thường. Sau khi tìm hiểu nguyên nhân thì ta nhận thấy có một vài hệ số (coefficient) của một số feature có giá trị rất cao . Hơn nữa, ta nhận thấy các hệ số này thuộc về feature </span><code>n_reviews</code><span> và số lượng rating theo từng điểm. Ta sẽ sử dụng </span><code>L2 Regularization</code><span> (Ridge) để giới hạn giá trị của các hệ số.</span></p><p><span>Kết quả khi sử dụng Ridge Regression (cùng với việc tinh chỉnh hyperparameter </span><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3735">α</span></span></span><script type="math/tex" id="MathJax-Element-192">\alpha</script></span><span> tốt nhất sử dụng phương pháp GridSearch trên tập </span><code>val</code><span>), ta có kết quả như sau:</span></p><p><code>Best cross-validation MAE: 505.34610839045035 with alpha = 100</code></p><table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>SIA-1000</span></th>
<th><span>SIA-500</span></th>
<th><span>SIA-200</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>681.87641</span></td>
<td><span>0.87953</span></td>
<td><span>0.78512</span></td>
<td><span>0.61469</span></td>
</tr>
<tr>
<td><span>val</span></td>
<td><span>602.002647</span></td>
<td><span>0.87616</span></td>
<td><span>0.77844</span></td>
<td><span>0.59771</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>541.09581</span></td>
<td><span>0.88327</span></td>
<td><span>0.78724</span></td>
<td><span>0.61476</span></td>
</tr>
</tbody>
</table><p><em><strong><span>Nhận xét:</span></strong></em><span> Khi sử dụng hồi quy ridge thì ta thấy kết quả tốt hơn so với ki sử dụng hồi quy tuyến tính các weight cũng nhỏ hơn so với mô hình hồi quy tuyến tính do sự ảnh hưởng của siêu tham số </span><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3737">α</span></span></span><script type="math/tex" id="MathJax-Element-193">\alpha</script></span></p><p><span>Ta thấy hiệu năng của mô hình </span><em><strong><span>thấp hơn</span></strong></em><span> phương pháp Random Forest khá nhiều (kể cả trên tập </span><code>train</code><span>). Điều này có thể là do mô hình vẫn chưa đủ phức tạp để nắm bắt được hết các thông tin từ input</span></p><hr><h4 id="Linear-Regression-sử-dụng-Mean-Encoding-cho-các-categorical-features" data-id="Linear-Regression-sử-dụng-Mean-Encoding-cho-các-categorical-features"><a class="anchor hidden-xs" href="#Linear-Regression-sử-dụng-Mean-Encoding-cho-các-categorical-features" title="Linear-Regression-sử-dụng-Mean-Encoding-cho-các-categorical-features"><span class="octicon octicon-link"></span></a><span>Linear Regression sử dụng Mean Encoding cho các categorical features:</span></h4><p><span>Kết quả:</span></p><table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>SIA-1000</span></th>
<th><span>SIA-500</span></th>
<th><span>SIA-200</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>817.73390</span></td>
<td><span>0.84025</span></td>
<td><span>0.745440</span></td>
<td><span>0.61203</span></td>
</tr>
<tr>
<td><span>val</span></td>
<td><span>736.71263</span></td>
<td><span>0.84186</span></td>
<td><span>0.737890</span></td>
<td><span>0.60452</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>674.41237</span></td>
<td><span>0.84495</span></td>
<td><span>0.74107</span></td>
<td><span>0.61324</span></td>
</tr>
</tbody>
</table><p><span>Ta thấy kết quả trên tập train cũng xấp xỉ kết quả trên tập val và test (ngược lại với mô hình Random Forest có độ lỗi trên tập train thấp hơn rất nhiều so với val và test). Có thể là do mô hình Linear Regression chưa phải là phù hợp nhất với tập dữ liệu của ta (</span><em><strong><span>lưu ý là Linear Regression có thể đưa ra kết quả dự đoán mang giá trị âm</span></strong></em><span>),</span><br>
<span>đặc biệt là đối với các </span><em><strong><span>categorical feature</span></strong></em><span> ? (Ta sẽ kiểm chứng điều này trong phần Neural Network)</span></p><h3 id="Neural-Network" data-id="Neural-Network"><a class="anchor hidden-xs" href="#Neural-Network" title="Neural-Network"><span class="octicon octicon-link"></span></a><span>Neural Network</span></h3><p><span>Tương tự như Linear Regression , ta sẽ tiền xử lý input bằng việc chuẩn hóa các features theo phương pháp Z-score normalization.</span><br>
<span>Ta sẽ thực nghiệm với 1 mạng Neural Network nhỏ như sau:</span></p><pre><code>Input Vector -&gt; FC(32 units) + ReLU -&gt; FC(64 units) + ReLU -&gt; Output (1 unit) + ReLU
</code></pre><p><span>Nguyên nhân ta sử dụng hàm ReLU activation lên output (thay vì Linear) là do ta muốn các giá trị dự đoán đều không âm.</span><br>
<span>Với weights của mỗi layer, ta sẽ sử dụng </span><code>L2-Regularization</code><span> với </span><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3739">α</span></span></span><script type="math/tex" id="MathJax-Element-194">\alpha</script></span><span> =0.1 để hạn chế việc overfitting.</span><br>
<span>Hàm mất mát ta sẽ sử dụng là hàm </span><code>MAE</code><span>:</span></p><p><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3741">L</span><span class="MJXp-mo" id="MJXp-Span-3742" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3743">y</span><span class="MJXp-mo" id="MJXp-Span-3744" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-3745"><span class="MJXp-munderover" id="MJXp-Span-3746"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3748" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3747">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3749" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3750" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3751" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3752">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3753">N</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-3754"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3760" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3761">N</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-3755" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3756" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3757">i</span><span class="MJXp-mo" id="MJXp-Span-3758">=</span><span class="MJXp-mn" id="MJXp-Span-3759">0</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-3762"><span class="MJXp-mo" id="MJXp-Span-3763" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3764">y</span><span class="MJXp-mo" id="MJXp-Span-3765" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-3766"><span class="MJXp-mrow" id="MJXp-Span-3767" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-3768"><span class="MJXp-munderover" id="MJXp-Span-3769"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3771" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3770">y</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3772" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mrow" id="MJXp-Span-3773"><span class="MJXp-mo" id="MJXp-Span-3774" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-195">\begin{equation}
    L(y, \hat{y}) = \frac{1}{N} \sum_{i=0}^{N}|y -     {\hat{y}}_i|
\end{equation}</script></span></p><h4 id="Sử-dụng-toàn-bộ-features-Onehot-Encoding--numeric" data-id="Sử-dụng-toàn-bộ-features-Onehot-Encoding--numeric"><a class="anchor hidden-xs" href="#Sử-dụng-toàn-bộ-features-Onehot-Encoding--numeric" title="Sử-dụng-toàn-bộ-features-Onehot-Encoding--numeric"><span class="octicon octicon-link"></span></a><span>Sử dụng toàn bộ features (Onehot Encoding + numeric):</span></h4><table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>SIA-1000</span></th>
<th><span>SIA-500</span></th>
<th><span>SIA-200</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>424.32375</span></td>
<td><span>0.94671</span></td>
<td><span>0.90634</span></td>
<td><span>0.82453</span></td>
</tr>
<tr>
<td><span>val</span></td>
<td><span>335.20732</span></td>
<td><span>0.94502</span></td>
<td><span>0.90011</span></td>
<td><span>0.81818</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>302.48544</span></td>
<td><span>0.94773</span></td>
<td><span>0.90571</span></td>
<td><span>0.81446</span></td>
</tr>
</tbody>
</table><hr><h4 id="Sử-dụng-features-Onehot-Encoding--numeric-trừ-avg_rating-và-n_reviews" data-id="Sử-dụng-features-Onehot-Encoding--numeric-trừ-avg_rating-và-n_reviews"><a class="anchor hidden-xs" href="#Sử-dụng-features-Onehot-Encoding--numeric-trừ-avg_rating-và-n_reviews" title="Sử-dụng-features-Onehot-Encoding--numeric-trừ-avg_rating-và-n_reviews"><span class="octicon octicon-link"></span></a><span>Sử dụng features (Onehot Encoding + numeric) trừ avg_rating và n_reviews:</span></h4><ul>
<li><span>Mô hình RandomForest</span>
<ul>
<li>
<p><span>Khi không loại bỏ avg_rating và n_reviews</span></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>SIA-1000</span></th>
<th><span>SIA-500</span></th>
<th><span>SIA-200</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>162.19769</span></td>
<td><span>0.97237</span></td>
<td><span>0.94480</span></td>
<td><span>0.88470</span></td>
</tr>
<tr>
<td><span>val</span></td>
<td><span>377.55629</span></td>
<td><span>0.92814</span></td>
<td><span>0.87425</span></td>
<td><span>0.78389</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>366.071744</span></td>
<td><span>0.93728</span></td>
<td><span>0.88197</span></td>
<td><span>0.78114</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><span>Khi loại bỏ avg_rating và n_reviews</span></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>SIA-1000</span></th>
<th><span>SIA-500</span></th>
<th><span>SIA-200</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>490.71191</span></td>
<td><span>0.93908</span></td>
<td><span>0.88647</span></td>
<td><span>0.77151</span></td>
</tr>
<tr>
<td><span>val</span></td>
<td><span>745.28144</span></td>
<td><span>0.88051</span></td>
<td><span>0.80240</span></td>
<td><span>0.63745</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>695.62715</span></td>
<td><span>0.88219</span></td>
<td><span>0.80096</span></td>
<td><span>0.63371</span></td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
</ul><hr><p><em><strong><span>Nhận xét</span></strong></em><span>:</span></p><p><span>Khi ta loại bỏ các thuộc tính như </span><em><strong><span>số lượng bán ra</span></strong></em><span> của các sản phẩm hay là </span><em><strong><span>điểm số trung bình</span></strong></em><span> người dùng cho sản phẩm đó thì kết quả của các độ đo tệ 1 cách trông thấy. Hay có nghĩa là khi giao diện tiki hiển thị các thông số này thì nó cũng phần nào </span><em><strong><span>ảnh hưởng đến quyết định mua hàng</span></strong></em><span> của người dùng trên sản phẩm đó</span></p><p><strong><span>KẾT LUẬN</span></strong><span>: Ta thấy hầu hết các sản phẩm đều có số lượt bán thấp (91.4% dữ liệu có số lượt bán dưới 1000). Do đó mà việc chúng ta làm giới hạn sai số dự đoán (epsilon) thấp sẽ giúp cho ta đánh giá một cách khách quan và phù hợp với bài toán và nhóm mình chọn metric SIA-200</span></p><p><span>Đối với mô hình Neural Network, khi ta sử dụng Onehot Encoding thì xem kết quả có vẻ hợp lý hơn so với khi sử dụng Mean Encoding cho các categorical features.</span></p><p><span>Theo các kết quả trên ta thấy 2 mô hình cho kết quả tốt nhất là Random Forest và Neural Network và đã sử dụng toàn bộ các features. </span><em><strong><span>Tuy nhiên</span></strong></em><span> mô hình Neural Network có thời gian </span><em><strong><span>train lâu</span></strong></em><span> hơn nhiều so với Random Forest.</span></p><p><span>Ta thấy khi ta loại bỏ 2 thuộc tính </span><em><strong><span>numerical avg_rating và n_reviews</span></strong></em><span> thì ta thấy hiệu quả khi dự đoán được sold giảm xuống đáng kể hầu hết trên các mô hình và SIA-200 rất thấp. Điều đó chứng tỏ khi mua hàng trên tiki 2 giá trị avg_rating(Điểm rating trung bình) và n_reviews(Số lượng người reviews) đã ảnh hưởng 1 cách khách quan tới họ khi quyết định có mua sản phẩm hay không.</span></p><p><em><strong><span>Vì vậy để có thể tăng lượng mua hàng thì phải cải thiện sao cho điểm avg_rating càng lớn càng tốt</span></strong></em></p><h2 id="Rating-Prediction" data-id="Rating-Prediction"><a class="anchor hidden-xs" href="#Rating-Prediction" title="Rating-Prediction"><span class="octicon octicon-link"></span></a><span>Rating Prediction</span></h2><hr><h3 id="Phương-pháp-phân-rã-ma-trận-matrix-factorization" data-id="Phương-pháp-phân-rã-ma-trận-matrix-factorization"><a class="anchor hidden-xs" href="#Phương-pháp-phân-rã-ma-trận-matrix-factorization" title="Phương-pháp-phân-rã-ma-trận-matrix-factorization"><span class="octicon octicon-link"></span></a><span>Phương pháp phân rã ma trận matrix factorization</span></h3><h4 id="Phân-tích-ma-trận-thành-nhân-tử" data-id="Phân-tích-ma-trận-thành-nhân-tử"><a class="anchor hidden-xs" href="#Phân-tích-ma-trận-thành-nhân-tử" title="Phân-tích-ma-trận-thành-nhân-tử"><span class="octicon octicon-link"></span></a><span>Phân tích ma trận thành nhân tử</span></h4><h5 id="Xấp-xỉ-bằng-2-ma-trận-tiềm-ẩn" data-id="Xấp-xỉ-bằng-2-ma-trận-tiềm-ẩn"><a class="anchor hidden-xs" href="#Xấp-xỉ-bằng-2-ma-trận-tiềm-ẩn" title="Xấp-xỉ-bằng-2-ma-trận-tiềm-ẩn"><span class="octicon octicon-link"></span></a><span>Xấp xỉ bằng 2 ma trận tiềm ẩn</span></h5><p><em><strong><span>Ý tưởng</span></strong></em><span> :Với ma trận user-item và giá trị của mỗi ô là điểm rating mà user đánh giá cho item, trong đó có các ô trống vì có những sản phẩm mà người dùng chưa mua. Ta sẽ xấp xỉ ma trận kết quả bằng 2 ma trận ẩn gọi là ma trận người dùng ẩn và ma trận sản phẩm ẩn</span></p><p><span>Gọi ma trận R là ma trận user-item chúng ta thành lập được khi đó ta sẽ xấp xỉ ma trận này bằng tích 2 ma trận ẩn P và Q.</span></p><p><span>Ma trận R có kích thước m x n với m người dùng và n sản phẩm.</span><br>
<span>Gọi 2 ma trận ẩn là ma trận P có kích thước m x k và ma trận Q có kích thước n x k (lấy k &lt;&lt; m, n)</span></p><p><span>Khi đó:</span></p><p><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3775"><span class="MJXp-mrow" id="MJXp-Span-3776"><span class="MJXp-munderover" id="MJXp-Span-3777"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-3779" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3778">R</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3780" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3781">P</span><span class="MJXp-msubsup" id="MJXp-Span-3782"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3783" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3784" style="vertical-align: 0.5em;">T</span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-196">\begin{equation}
\hat{R}  = PQ^T
\end{equation}</script></span></p><p><span>Củ thể đối với điểm rating người dùng u đánh giá sản phẩm i ta có:</span><br>
<span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3785"><span class="MJXp-mrow" id="MJXp-Span-3786"><span class="MJXp-munderover" id="MJXp-Span-3787"><span><span class="MJXp-over"><span><span class="MJXp-mo" id="MJXp-Span-3791" style="margin-left: 0px; margin-right: 0px;">^</span></span><span><span class="MJXp-msubsup" id="MJXp-Span-3788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3789" style="margin-right: 0.05em;">R</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-3790" style="vertical-align: -0.4em;">ui</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3792" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3794" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3795" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-msubsup" id="MJXp-Span-3796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3797" style="margin-right: 0.05em;">q</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3799">T</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3798">i</span></span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-197">\begin{equation}
\hat{R_\text{ui}}  = p_u q_i^T
\end{equation}</script></span></p><h5 id="Ý-nghĩa-của-2-ma-trận-tiềm-ẩn" data-id="Ý-nghĩa-của-2-ma-trận-tiềm-ẩn"><a class="anchor hidden-xs" href="#Ý-nghĩa-của-2-ma-trận-tiềm-ẩn" title="Ý-nghĩa-của-2-ma-trận-tiềm-ẩn"><span class="octicon octicon-link"></span></a><span>Ý nghĩa của 2 ma trận tiềm ẩn</span></h5><p><span>Ma trận tiềm ẩn P của người dùng trong đó hàng pu của ma trận sẽ chứa các giá trị là mức dộ yêu thích của người dùng u với các đặc trưng của 1 sản phẩm ví dụ như miêu tả, giá, hình ảnh, …</span></p><p><span>Ma trận tiềm Q của các sản phẩm trong đó hàng qi sẽ chứa các giá trị đo lường mức độ sở hữu các đặc trưng như  là tiêu đề, miểu tả hay là hình ảnh sản phẩm</span></p><p><em><strong><span>Chú ý</span></strong></em><span>: Ở các công thức trên có đề cập thì ta có thêm bias bu.</span><br>
<span>Vì sao lại phải thêm bias cho từng user?</span></p><p><span>Tùy thuộc vào tính cách đối với các sản phẩm của mỗi người mà họ có thể quyết định số điểm mà họ đánh giá cho sản phẩm đó.</span></p><p><em><strong><span>Lý do:</span></strong></em><span> Có người dễ tính, có người khó tính, dễ tính 1 cuốn sách hay có thể cho 5 sao nhưng mà khó tính có thể chỉ cho 4 sao hoặc thậm chí là 3 sao chẳng hạn.</span></p><p><span>Vậy để giải quyết vấn đề này nhóm chúng tôi đã lấy bias của mỗi user là trung bình cộng số điểm mà người đó rating cho những sản phẩm mà người ấy mua.</span></p><h4 id="Hàm-mất-mát" data-id="Hàm-mất-mát"><a class="anchor hidden-xs" href="#Hàm-mất-mát" title="Hàm-mất-mát"><span class="octicon octicon-link"></span></a><span>Hàm mất mát</span></h4><p><span>Hàm lỗi nhóm chúng tôi sử dụng là trung bình cộng của bình phương độ chênh lệch kết quả dự doán và kết quả thực tế và dùng thêm l2 regularization để tránh overfitting</span></p><p><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3800"><span class="MJXp-mtext" id="MJXp-Span-3801">RSS</span><span class="MJXp-mo" id="MJXp-Span-3802" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3803">y</span><span class="MJXp-mo" id="MJXp-Span-3804" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-3805"><span class="MJXp-munderover" id="MJXp-Span-3806"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3808" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3807">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3809" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3810" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3811"><span class="MJXp-mfrac" id="MJXp-Span-3812" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3813">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3814">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-3815"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3821" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3822">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-3816" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3817" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3818">i</span><span class="MJXp-mo" id="MJXp-Span-3819">=</span><span class="MJXp-mn" id="MJXp-Span-3820">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3823" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3825" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3826" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3827" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-3828"><span class="MJXp-mrow" id="MJXp-Span-3829" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3830"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3832" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3831">y</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3833" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-3834"><span class="MJXp-mo" id="MJXp-Span-3835" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3836" style="vertical-align: 0.5em;">2</span></span></span></span></span><script type="math/tex" id="MathJax-Element-198">\text{RSS}(y, \hat{y}) = {\frac{1}{m} \sum\limits_{i=1}^{m} (y_i - \hat{y}_i)^2}</script></span></p><p><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3837"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3838">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3839">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3840">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3841">s</span><span class="MJXp-mo" id="MJXp-Span-3842" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3843">y</span><span class="MJXp-mo" id="MJXp-Span-3844" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-3845"><span class="MJXp-munderover" id="MJXp-Span-3846"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3848" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3847">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3849" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3850" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-3851">RSS</span><span class="MJXp-mo" id="MJXp-Span-3852" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3853">y</span><span class="MJXp-mo" id="MJXp-Span-3854" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-3855"><span class="MJXp-munderover" id="MJXp-Span-3856"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3858" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3857">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3859" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3860" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-3861">Regularization_Func(P, Q)</span></span></span><script type="math/tex" id="MathJax-Element-199">Loss(y, \hat{y}) = \text{RSS}(y, \hat{y}) + \text{Regularization_Func(P, Q)}</script></span></p><p><em><strong><span>Chú ý:</span></strong></em><span> Ở đây nhóm chúng tôi chọn hàm hiệu chỉnh có công thức là:</span></p><p><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3862"><span class="MJXp-mtext" id="MJXp-Span-3863">Regularization_Func(P, Q)</span><span class="MJXp-mo" id="MJXp-Span-3864" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3865" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3866">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3867">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3868" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span><span class="MJXp-mrow" id="MJXp-Span-3869"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3870">λ</span></span><span class="MJXp-mo" id="MJXp-Span-3871" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span><span class="MJXp-mo" id="MJXp-Span-3872" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msqrt" id="MJXp-Span-3873"><span class="MJXp-surd"><span class="MJXp-right MJXp-scale5" style="font-size: 326%; margin-top: 0.043em; margin-left: -0.273em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.113em solid;"></span><span class="MJXp-box"><span class="MJXp-munderover" id="MJXp-Span-3874"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3880" style="margin-right: 0px; margin-left: 0px;">m</span></span><span><span class="MJXp-mo" id="MJXp-Span-3875" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3876" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3877">i</span><span class="MJXp-mo" id="MJXp-Span-3878">=</span><span class="MJXp-mn" id="MJXp-Span-3879">1</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-3881"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3887" style="margin-right: 0px; margin-left: 0px;">k</span></span><span><span class="MJXp-mo" id="MJXp-Span-3882" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3883" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3884">j</span><span class="MJXp-mo" id="MJXp-Span-3885">=</span><span class="MJXp-mn" id="MJXp-Span-3886">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-3888"><span class="MJXp-mo" id="MJXp-Span-3889" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-3890"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3891" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3892" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3893">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3894">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3895"><span class="MJXp-mrow" id="MJXp-Span-3896" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-3897" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3898" style="vertical-align: 0.5em;">2</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3899" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msqrt" id="MJXp-Span-3900"><span class="MJXp-surd"><span class="MJXp-right MJXp-scale5" style="font-size: 326%; margin-top: 0.043em; margin-left: -0.273em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.113em solid;"></span><span class="MJXp-box"><span class="MJXp-munderover" id="MJXp-Span-3901"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3907" style="margin-right: 0px; margin-left: 0px;">n</span></span><span><span class="MJXp-mo" id="MJXp-Span-3902" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3903" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3904">i</span><span class="MJXp-mo" id="MJXp-Span-3905">=</span><span class="MJXp-mn" id="MJXp-Span-3906">1</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-3908"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3914" style="margin-right: 0px; margin-left: 0px;">k</span></span><span><span class="MJXp-mo" id="MJXp-Span-3909" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3910" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3911">j</span><span class="MJXp-mo" id="MJXp-Span-3912">=</span><span class="MJXp-mn" id="MJXp-Span-3913">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-3915"><span class="MJXp-mo" id="MJXp-Span-3916" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-3917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3918" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3919" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3920">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3921">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3922"><span class="MJXp-mrow" id="MJXp-Span-3923" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-3924" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3925" style="vertical-align: 0.5em;">2</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3926" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-200">\text{Regularization_Func(P, Q)} = \frac{1}{2} * {\lambda} *  (\sqrt{\sum\limits_{i=1}^m \sum\limits_{j=1}^k |p_{ij}|^2} + \sqrt{\sum\limits_{i=1}^n \sum\limits_{j=1}^k |q_{ij}|^2} )</script></span></p><h4 id="Đánh-giá-mô-hình" data-id="Đánh-giá-mô-hình"><a class="anchor hidden-xs" href="#Đánh-giá-mô-hình" title="Đánh-giá-mô-hình"><span class="octicon octicon-link"></span></a><span>Đánh giá mô hình</span></h4><p><span>Kết quả:</span></p><ul>
<li><em><strong><span>Khi lamda=0</span></strong></em></li>
</ul><table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>1.04395</span></td>
<td><span>1.98347</span></td>
<td><span>0.62074</span></td>
<td><span>0.35644</span></td>
<td><span>0.27500</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>1.17288</span></td>
<td><span>2.42820</span></td>
<td><span>0.58087</span></td>
<td><span>0.32911</span></td>
<td><span>0.26582</span></td>
</tr>
</tbody>
</table><ul>
<li><em><strong><span>Khi lamda=0.1</span></strong></em></li>
</ul><table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.50272</span></td>
<td><span>0.53481</span></td>
<td><span>0.84673</span></td>
<td><span>0.62301</span></td>
<td><span>0.42093</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.55700</span></td>
<td><span>0.65482</span></td>
<td><span>0.81935</span></td>
<td><span>0.58907</span></td>
<td><span>0.39576</span></td>
</tr>
</tbody>
</table><ul>
<li><em><strong><span>Khi lamda=0.5</span></strong></em></li>
</ul><table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.50272</span></td>
<td><span>0.53481</span></td>
<td><span>0.85770</span></td>
<td><span>0.55698</span></td>
<td><span>0.43130</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.55698</span></td>
<td><span>0.65482</span></td>
<td><span>0.83460</span></td>
<td><span>0.60736</span></td>
<td><span>0.40702</span></td>
</tr>
</tbody>
</table><ul>
<li><em><strong><span>Khi lamda=1</span></strong></em></li>
</ul><table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.50272</span></td>
<td><span>0.53481</span></td>
<td><span>0.85770</span></td>
<td><span>0.63992</span></td>
<td><span>0.43130</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.55698</span></td>
<td><span>0.65482</span></td>
<td><span>0.83458</span></td>
<td><span>0.60736</span></td>
<td><span>0.40702</span></td>
</tr>
</tbody>
</table><p><em><strong><span>Nhận xét</span></strong></em><span>:</span></p><p><span>Khi </span><em><strong><span>lamda=0</span></strong></em><span>, ta thấy mô hình đạt độ chính xác khá thấp cả tập train và tập test, đặc biệt tập tain có độ chính xác còn cao hơn tập test. Việc loại bỏ hiệu chỉnh l2 khiến cho mô hình học khá tệ</span></p><p><span>Khi cho </span><em><strong><span>lamda != 0</span></strong></em><span> ta thấy mô hình đạt được độ chính xác khá tốt và tập test và tập train không chênh lệch nhiều Hiệu năng trên tập </span><code>val</code><span> và </span><code>test</code><span> lệch nhau khá ít ở các độ đo MAE và MSE.</span></p><p><span>Khi </span><em><strong><span>lamda=0.1, 0.5, 1</span></strong></em><span> kết quả gần nhữ xấp xỉ nhau nên nhóm chon </span><em><strong><span>lamda=0.5</span></strong></em><span> làm kết quả cuối cùng</span></p><p><span>Đối với SIA metric thì ta thấy 83% mẫu test mình dự đoán trong vùng chấp nhận được với sai số là 1 và tiếp tục 2 độ đo SIA 0.5 và 0.25 ở mức trung bình lần lượt là 61% và 41%  trên tập test. Mô hình cho kết quả tốt hơn khi thêm hiểu chỉnh l2. Nhóm dự đoán có thể do trong quá trình review sản phẩm thì rất là khó để chúng ta phân biêt được khi nào nên rating 2, khi nào nên rating 3, nên nhóm quyết định sẽ lấy độ đo SIA 1 làm độ đo chính cho các mô hình phía sau và bên cạnh đó có 2 độ đo giúp ta giám sát nữa là MAE tính trung bình trị tuyệt đối độ chênh lệch và MSE trung bình phương độ chênh lệch.</span></p><p><em><strong><span>Với lamda=0.5:</span></strong></em></p><ul>
<li><span>learning_rate=0.1:</span></li>
</ul><table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.50273</span></td>
<td><span>0.53481</span></td>
<td><span>0.84595</span></td>
<td><span>0.62260</span></td>
<td><span>0.421023</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.55699</span></td>
<td><span>0.65482</span></td>
<td><span>0.82091</span></td>
<td><span>0.59001</span></td>
<td><span>0.39600</span></td>
</tr>
</tbody>
</table><ul>
<li><span>learning_rate=0.5:</span></li>
</ul><table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.50272</span></td>
<td><span>0.53481</span></td>
<td><span>0.85770</span></td>
<td><span>0.63992</span></td>
<td><span>0.43130</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.55698</span></td>
<td><span>0.65482</span></td>
<td><span>0.83458</span></td>
<td><span>0.60736</span></td>
<td><span>0.40702</span></td>
</tr>
</tbody>
</table><ul>
<li><span>learning_rate=0.75:</span></li>
</ul><table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.50272</span></td>
<td><span>0.53481</span></td>
<td><span>0.85770</span></td>
<td><span>0.63992</span></td>
<td><span>0.43130</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.55698</span></td>
<td><span>0.65482</span></td>
<td><span>0.83458</span></td>
<td><span>0.60736</span></td>
<td><span>0.40702</span></td>
</tr>
</tbody>
</table><ul>
<li><span>learning_rate=1:</span></li>
</ul><table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.50272</span></td>
<td><span>0.53481</span></td>
<td><span>0.85770</span></td>
<td><span>0.63992</span></td>
<td><span>0.43130</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.55698</span></td>
<td><span>0.65482</span></td>
<td><span>0.83458</span></td>
<td><span>0.60736</span></td>
<td><span>0.40702</span></td>
</tr>
</tbody>
</table><p><em><strong><span>Nhận xét:</span></strong></em><span> Khi thay đổi các giá trị learning rate thì ta thấy các với các giá trị 0.5 trờ lên thì giá trị giữa các độ đo khá xấp xỉ nhau nên ta chọn </span><em><strong><span>learning_rate=0.75</span></strong></em><span> làm giá trị cuối cùng</span></p><hr><h3 id="Phương-pháp-gợi-ý-dựa-trên-nội-dung-content-based" data-id="Phương-pháp-gợi-ý-dựa-trên-nội-dung-content-based"><a class="anchor hidden-xs" href="#Phương-pháp-gợi-ý-dựa-trên-nội-dung-content-based" title="Phương-pháp-gợi-ý-dựa-trên-nội-dung-content-based"><span class="octicon octicon-link"></span></a><span>Phương pháp gợi ý dựa trên nội dung content-based</span></h3><h4 id="Xây-dựng-feature-vector-bằng-TF-IDF" data-id="Xây-dựng-feature-vector-bằng-TF-IDF"><a class="anchor hidden-xs" href="#Xây-dựng-feature-vector-bằng-TF-IDF" title="Xây-dựng-feature-vector-bằng-TF-IDF"><span class="octicon octicon-link"></span></a><span>Xây dựng feature vector bằng TF-IDF</span></h4><p><span>Trong bộ dataset item/detail_list.csv, thì chúng ta có hơn 1000 cột chi tiết là 1000 cột lĩnh vực, 1 sản phẩm có thể thuộc nhiều lĩnh vực</span></p><p><em><strong><span>VD:</span></strong></em><span> Lĩnh vực của 1 sản phẩm là </span><em><strong><span>bách hóa online/sữa và các sản phẩm từ sữa/sữa nước/sữa chua uống &amp; ăn</span></strong></em><span> khi đó các cột bách hóa online, sữa và các sản phẩm từ sữa và sữa nước, sữa chua uống &amp; ăn của sản phẩm có giá trị là 1 và các cột lĩnh vực còn lại có giá trị 0.</span></p><p><span>Ta sẽ xây dựng ma trận feature vector bằng TF-IDF trong đó từng hàng của  ma trận chính là feature vector của từng sản phẩm</span></p><h4 id="Xây-dựng-mô-hình-cho-mỗi-user" data-id="Xây-dựng-mô-hình-cho-mỗi-user"><a class="anchor hidden-xs" href="#Xây-dựng-mô-hình-cho-mỗi-user" title="Xây-dựng-mô-hình-cho-mỗi-user"><span class="octicon octicon-link"></span></a><span>Xây dựng mô hình cho mỗi user</span></h4><p><span>Sau khi có được ma trận feature vector, ta sẽ xây dựng mô hình cho riêng từng user, ở đây nhóm chúng tôi dùng mô hình hồi quy đơn giản, củ thể ở đây bọn em dùng các mô hình như hỗ quy tuyến tính (Linear Regression)  và  thêm mô hình hồi quy Ridge (Ridge Regression)</span></p><h4 id="Hàm-lỗi" data-id="Hàm-lỗi"><a class="anchor hidden-xs" href="#Hàm-lỗi" title="Hàm-lỗi"><span class="octicon octicon-link"></span></a><span>Hàm lỗi</span></h4><p><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3927"><span class="MJXp-mtext" id="MJXp-Span-3928">RSS</span><span class="MJXp-mo" id="MJXp-Span-3929" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3930">y</span><span class="MJXp-mo" id="MJXp-Span-3931" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-3932"><span class="MJXp-munderover" id="MJXp-Span-3933"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3935" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3934">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3936" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3937" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3938"><span class="MJXp-mfrac" id="MJXp-Span-3939" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3940">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3941">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-3942"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3948" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3949">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-3943" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3944" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3945">i</span><span class="MJXp-mo" id="MJXp-Span-3946">=</span><span class="MJXp-mn" id="MJXp-Span-3947">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3950" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3951"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3952" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3953" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3954" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-3955"><span class="MJXp-mrow" id="MJXp-Span-3956" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3957"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3959" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3958">y</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3960" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-3961"><span class="MJXp-mo" id="MJXp-Span-3962" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3963" style="vertical-align: 0.5em;">2</span></span></span></span></span><script type="math/tex" id="MathJax-Element-201">\text{RSS}(y, \hat{y}) = {\frac{1}{m} \sum\limits_{i=1}^{m} (y_i - \hat{y}_i)^2}</script></span></p><p><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3965">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3966">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3967">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3968">s</span><span class="MJXp-mo" id="MJXp-Span-3969" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3970">y</span><span class="MJXp-mo" id="MJXp-Span-3971" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-3972"><span class="MJXp-munderover" id="MJXp-Span-3973"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3975" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3974">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3976" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3977" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-3978">RSS</span><span class="MJXp-mo" id="MJXp-Span-3979" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3980">y</span><span class="MJXp-mo" id="MJXp-Span-3981" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-3982"><span class="MJXp-munderover" id="MJXp-Span-3983"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3985" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3984">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3986" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3987" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-3988">Regularization_Func</span></span></span><script type="math/tex" id="MathJax-Element-202">Loss(y, \hat{y}) = \text{RSS}(y, \hat{y}) + \text{Regularization_Func}</script></span></p><p><em><strong><span>Đầu vào:</span></strong></em></p><ul>
<li><span>Đầu vào X của user u là feature extractor của các sản phẩm mà u đánh giá</span></li>
<li><span>Đầu vào y của user u là các điểm đánh giá cho các sản phẩm mà u đã mua hoặc xem</span></li>
</ul><h4 id="Đánh-giá-mô-hình1" data-id="Đánh-giá-mô-hình"><a class="anchor hidden-xs" href="#Đánh-giá-mô-hình1" title="Đánh-giá-mô-hình1"><span class="octicon octicon-link"></span></a><span>Đánh giá mô hình</span></h4><p><span>Kết quả:</span></p><ul>
<li><span>Mô hình Linear Regression</span></li>
</ul><table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.01832</span></td>
<td><span>0.01603</span></td>
<td><span>0.99609</span></td>
<td><span>0.98568</span></td>
<td><span>0.97560</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.56011</span></td>
<td><span>0.69510</span></td>
<td><span>0.81685</span></td>
<td><span>0.58751</span></td>
<td><span>0.42547</span></td>
</tr>
</tbody>
</table><ul>
<li><span>Mô hình Ridge Regression:</span>
<ul>
<li>
<p><em><strong><span>(</span><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3989"><span class="MJXp-mrow" id="MJXp-Span-3990"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3991">λ</span></span></span></span><script type="math/tex" id="MathJax-Element-203">{\lambda}</script></span><span>=0.1)</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.03094</span></td>
<td><span>0.01281</span></td>
<td><span>0.99592</span></td>
<td><span>0.98588</span></td>
<td><span>0.97865</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.55879</span></td>
<td><span>0.69046</span></td>
<td><span>0.81912</span></td>
<td><span>0.58844</span></td>
<td><span>0.42476</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><em><strong><span>(</span><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3992"><span class="MJXp-mrow" id="MJXp-Span-3993"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3994">λ</span></span></span></span><script type="math/tex" id="MathJax-Element-204">{\lambda}</script></span><span>=1)</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.13520</span></td>
<td><span>04596</span></td>
<td><span>0.99572</span></td>
<td><span>0.96206</span></td>
<td><span>0.83152</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.55710</span></td>
<td><span>0.67331</span></td>
<td><span>0.82107</span></td>
<td><span>0.59055</span></td>
<td><span>0.41554</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><em><strong><span>(</span><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3995"><span class="MJXp-mrow" id="MJXp-Span-3996"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3997">λ</span></span></span></span><script type="math/tex" id="MathJax-Element-205">{\lambda}</script></span><span>=5)</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.31184</span></td>
<td><span>0.20825</span></td>
<td><span>0.94661</span></td>
<td><span>0.77916</span></td>
<td><span>0.55950</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.55544</span></td>
<td><span>0.65578</span></td>
<td><span>0.82326</span></td>
<td><span>0.59001</span></td>
<td><span>0.40194</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><em><strong><span>(</span><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3998"><span class="MJXp-mrow" id="MJXp-Span-3999"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4000">λ</span></span></span></span><script type="math/tex" id="MathJax-Element-206">{\lambda}</script></span><span>=10)</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.38261</span></td>
<td><span>0.31053</span></td>
<td><span>0.90810</span></td>
<td><span>0.71436</span></td>
<td><span>0.49440</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.55554</span></td>
<td><span>0.65317</span></td>
<td><span>0.82381</span></td>
<td><span>0.59102</span></td>
<td><span>0.39811</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><em><strong><span>(</span><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4001"><span class="MJXp-mrow" id="MJXp-Span-4002"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4003">λ</span></span></span></span><script type="math/tex" id="MathJax-Element-207">{\lambda}</script></span><span>=100)</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.48703</span></td>
<td><span>0.50171</span></td>
<td><span>0.85758</span></td>
<td><span>0.63940</span></td>
<td><span>0.43034</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.55688</span></td>
<td><span>0.65435</span></td>
<td><span>0.82459</span></td>
<td><span>0.59141</span></td>
<td><span>0.39803</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><em><strong><span>(</span><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4004"><span class="MJXp-mrow" id="MJXp-Span-4005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4006">λ</span></span></span></span><script type="math/tex" id="MathJax-Element-208">{\lambda}</script></span><span>=500)</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.49953</span></td>
<td><span>0.52794</span></td>
<td><span>0.85741</span></td>
<td><span>0.63891</span></td>
<td><span>0.43009</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.55714</span></td>
<td><span>0.65491</span></td>
<td><span>0.82451</span></td>
<td><span>0.59181</span></td>
<td><span>0.39826</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><em><strong><span>(</span><span class="mathjax raw"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4007"><span class="MJXp-mrow" id="MJXp-Span-4008"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4009">λ</span></span></span></span><script type="math/tex" id="MathJax-Element-209">{\lambda}</script></span><span>=1000)</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.49953</span></td>
<td><span>0.52794</span></td>
<td><span>0.85741</span></td>
<td><span>0.63891</span></td>
<td><span>0.43009</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.55714</span></td>
<td><span>0.65491</span></td>
<td><span>0.82451</span></td>
<td><span>0.59181</span></td>
<td><span>0.39826</span></td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
</ul><p><em><strong><span>Nhận xét</span></strong></em><span>:</span></p><p><span>Xét trên độ đo chính mà nhóm chúng tôi sử dụng thì trên cả 2 mô hình Ridge và Linear Regression là SIA 1, ta thấy mô hình Linear Regession có 81.6% mẫu trên tập test được dự đoán thuộc vùng chấp nhận được còn mô hình Ridge với </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-188-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03BB;</mi></mrow><mo>=</mo><mn>5</mn><mo>,</mo><mn>100</mn><mo>,</mo><mn>100</mn><mo>,</mo><mn>500</mn><mo>,</mo><mn>1000</mn></math>" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-4356" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4357" class="mjx-mrow"><span id="MJXc-Node-4358" class="mjx-texatom"><span id="MJXc-Node-4359" class="mjx-mrow"><span id="MJXc-Node-4360" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">λ</span></span></span></span><span id="MJXc-Node-4361" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-4362" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">5</span></span><span id="MJXc-Node-4363" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.556em;">,</span></span><span id="MJXc-Node-4364" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">100</span></span><span id="MJXc-Node-4365" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.556em;">,</span></span><span id="MJXc-Node-4366" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">100</span></span><span id="MJXc-Node-4367" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.556em;">,</span></span><span id="MJXc-Node-4368" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">500</span></span><span id="MJXc-Node-4369" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.556em;">,</span></span><span id="MJXc-Node-4370" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">1000</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi>λ</mi></mrow><mo>=</mo><mn>5</mn><mo>,</mo><mn>100</mn><mo>,</mo><mn>100</mn><mo>,</mo><mn>500</mn><mo>,</mo><mn>1000</mn></math></span></span><script type="math/tex" id="MathJax-Element-188">{\lambda} = 5, 100, 100, 500, 1000</script></span><span> thì cao hơn 1 chút, khoảng 82.5% mẫu trên tập test được dự đoán thuộc vùng chấp nhận được.</span></p><p><span>Tuy nhiên thì khi sử dụng mô hình linear regression thì ta thấy mô hình bị </span><em><strong><span>overfit</span></strong></em><span> quá nặng vì vậy ta sử dụng hồi quy ridge, mô hình có vẻ hiểu quả hơn hồi quy tuyến tính, sở dĩ là vì có siêu tham số alpha giúp cho hồi quy ridge chống hiện tượng overfitting.</span><br>
<span>Ta chọn </span><em><strong><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-189-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03BB;</mi></mrow><mo>=</mo><mn>100</mn></math>" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-4371" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4372" class="mjx-mrow"><span id="MJXc-Node-4373" class="mjx-texatom"><span id="MJXc-Node-4374" class="mjx-mrow"><span id="MJXc-Node-4375" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">λ</span></span></span></span><span id="MJXc-Node-4376" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-4377" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">100</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi>λ</mi></mrow><mo>=</mo><mn>100</mn></math></span></span><script type="math/tex" id="MathJax-Element-189">{\lambda} = 100</script></span></strong></em><span>. Dễ thấy mô hình này tệ hơn mô hình Matrix factorization ở trên</span></p><hr><h3 id="Ứng-dụng-1-số-neural-network-đơn-giản-cho-bài-toán-rating-prediction" data-id="Ứng-dụng-1-số-neural-network-đơn-giản-cho-bài-toán-rating-prediction"><a class="anchor hidden-xs" href="#Ứng-dụng-1-số-neural-network-đơn-giản-cho-bài-toán-rating-prediction" title="Ứng-dụng-1-số-neural-network-đơn-giản-cho-bài-toán-rating-prediction"><span class="octicon octicon-link"></span></a><span>Ứng dụng 1 số neural network đơn giản cho bài toán rating prediction</span></h3><h4 id="Áp-dụng-MLP-và-GMF-cho-phương-pháp-phân-rã-ma-trận-matrix-factorization" data-id="Áp-dụng-MLP-và-GMF-cho-phương-pháp-phân-rã-ma-trận-matrix-factorization"><a class="anchor hidden-xs" href="#Áp-dụng-MLP-và-GMF-cho-phương-pháp-phân-rã-ma-trận-matrix-factorization" title="Áp-dụng-MLP-và-GMF-cho-phương-pháp-phân-rã-ma-trận-matrix-factorization"><span class="octicon octicon-link"></span></a><span>Áp dụng MLP và GMF cho phương pháp phân rã ma trận matrix factorization</span></h4><h5 id="Ý-tưởng" data-id="Ý-tưởng"><a class="anchor hidden-xs" href="#Ý-tưởng" title="Ý-tưởng"><span class="octicon octicon-link"></span></a><span>Ý tưởng</span></h5><p><span>Như các bạn đã biết thì phương pháp phân rã ma trận đã đề cập ở trên thì chúng ta đi tìm 2 ma trận ẩn của người dùng và phim sao cho tích của chúng làm sao để sát với ma trận đánh giá nhất có thể là càng tốt.</span></p><p><span>Tính đơn giản của phép nhân tích vô hướng của 2 ma trận, rất khó để học được các thuộc tính ẩn của cả user và phim.</span></p><p><span>Vì vậy ở mục này nhóm chúng tôi xin đề cập tới 1 mạng phân rã ma trận nơ ron có tên là NeuMF. Sở dĩ nhóm chúng tôi đề cập tới mạng nơ ron nhân tạo ở đây bởi vì tính linh hoạt và tính phi tuyến của nó.</span></p><p><span>Ở trong mục này nhóm chúng tôi sẽ đề cập tới 2 mạng con có tên là phân rã ma trận tổng quát (</span><em><strong><span>Generalized Matrix Factorization) hay GMF</span></strong></em><span> và 1 mạng con nữa là </span><em><strong><span>MLP</span></strong></em></p><p><span>nhóm chúng tôi sẽ sử dụng từng mạng một và kết hợp chúng lại với nhau và đánh giá kết quả của các mạng này ở mục sau</span></p><h5 id="GMF---Generalized-Matrix-Factorization" data-id="GMF---Generalized-Matrix-Factorization"><a class="anchor hidden-xs" href="#GMF---Generalized-Matrix-Factorization" title="GMF---Generalized-Matrix-Factorization"><span class="octicon octicon-link"></span></a><span>GMF - Generalized Matrix Factorization</span></h5><h6 id="Mô-hình" data-id="Mô-hình"><a class="anchor hidden-xs" href="#Mô-hình" title="Mô-hình"><span class="octicon octicon-link"></span></a><span>Mô hình</span></h6><p><span>Mạng con GMF tương tự như cấu trúc ở phương pháp Matrix Factorization nhóm chúng tôi đã đề cập ở trước với 2 ma trận tiềm ẩn user embedding của user và item embedding của film với size lần lượt là </span><em><strong><span>(num_users + 1) * latent_dim và (num_items + 1) * latent_dim</span></strong></em></p><p><em><strong><span>Trong đó:</span></strong></em><span> num_users và num_items là số lượng user và item, latent_dim là </span><em><strong><span>số đặc trưng ẩn</span></strong></em><span> của phim và user mà bạn muốn   model của bạn học.</span></p><p><em><strong><span>Vì sao lại cộng 1 trong num_users và num_items?</span></strong></em></p><p><span>Như chúng ta đã biết thì hệ thống không có số lượt user và item cố định vì vậy khi đâu vào là 1 user hoặc 1 item mới mà không có trong hệ thống trước đó thì user hoặc item đó sẽ mang giá trị là </span><em><strong>&lt;OOV&gt;<span>(Tương tự như 1 từ không tồn tại trong từ điển)</span></strong></em></p><p><em><strong><span>Chú ý:</span></strong></em><span> trong quá trình cài đặt thuật toán nhóm chúng tôi có thể thêm </span><em><strong><span>Embedding regularizer l2</span></strong></em><span> để có thể tránh overfitting cho cả user và item</span></p><p><span>Sau khi tạo 2 ma trận tiềm ẩn cho user và item thì ta làm dãn 2 ma trận này và thực hiện tính tích 2 ma trận này (element-wise) và cuối cùng cho qua 1 lớp </span><em><strong><span>Dense size 1</span></strong></em><span> và đó chính là điểm rating được predict.</span></p><p><span>Cấu trúc mạng và tính toán tham số:</span></p><p><img src="https://i.imgur.com/xEdJ6HQ.png" alt="" loading="lazy"></p><h6 id="Đánh-giá-mô-hình2" data-id="Đánh-giá-mô-hình"><a class="anchor hidden-xs" href="#Đánh-giá-mô-hình2" title="Đánh-giá-mô-hình2"><span class="octicon octicon-link"></span></a><span>Đánh giá mô hình</span></h6><ul>
<li>
<p><span>Matrix Factorization đơn giản</span></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.50272</span></td>
<td><span>0.53481</span></td>
<td><span>0.85770</span></td>
<td><span>0.63992</span></td>
<td><span>0.43130</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.55698</span></td>
<td><span>0.65482</span></td>
<td><span>0.83458</span></td>
<td><span>0.60736</span></td>
<td><span>0.40702</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><span>Matrix Factorization khi áp dụng thêm GMF</span><br>
<em><strong><span>Kernels:</span></strong></em></p>
<ul>
<li>
<p><em><strong><span>Glorot-normal</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.47750</span></td>
<td><span>1.01940</span></td>
<td><span>0.81559</span></td>
<td><span>0.77183</span></td>
<td><span>0.71557</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>1.74336</span></td>
<td><span>4.13424</span></td>
<td><span>0.27227</span></td>
<td><span>0.12539</span></td>
<td><span>0.04804</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><em><strong><span>Glorot-uniform</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.46440</span></td>
<td><span>0.94953</span></td>
<td><span>0.81784</span></td>
<td><span>0.77584</span></td>
<td><span>0.72456</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>1.64592</span></td>
<td><span>3.66682</span></td>
<td><span>0.26914</span></td>
<td><span>0.14102</span></td>
<td><span>0.06289</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><em><strong><span>He-normal</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.46788</span></td>
<td><span>0.97932</span></td>
<td><span>0.82077</span></td>
<td><span>0.77300</span></td>
<td><span>0.72133</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>1.69154</span></td>
<td><span>3.88677</span></td>
<td><span>0.26914</span></td>
<td><span>0.13828</span></td>
<td><span>0.05703</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><em><strong><span>He-uniform</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.47529</span></td>
<td><span>1.01240</span></td>
<td><span>0.81657</span></td>
<td><span>0.77330</span></td>
<td><span>0.72280</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>1.728366</span></td>
<td><span>4.03914</span></td>
<td><span>0.26055</span></td>
<td><span>0.13008</span></td>
<td><span>0.04805</span></td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
</ul><p><em><strong><span>Nhận xét:</span></strong></em><br>
<span>Hầu hết trên toàn bộ độ đo trên tập train, test, GMF tệ hơn mô hình matrix factorization. Mô hình đang bị overfit quá nặng và nhìn qua mô hình là vẫn chưa có thêm nhiều </span><em><strong><span>tính phi tuyến của mạng neural network</span></strong></em><span> như ta đã nói từ trước.</span></p><p><span>Ta sẽ cải thiện với mô hình dưới.</span></p><h5 id="MLP---Multilayer-perceptron" data-id="MLP---Multilayer-perceptron"><a class="anchor hidden-xs" href="#MLP---Multilayer-perceptron" title="MLP---Multilayer-perceptron"><span class="octicon octicon-link"></span></a><span>MLP - Multilayer perceptron</span></h5><h6 id="Mô-hình1" data-id="Mô-hình"><a class="anchor hidden-xs" href="#Mô-hình1" title="Mô-hình1"><span class="octicon octicon-link"></span></a><span>Mô hình</span></h6><p><span>Mô hình MLP là 1 mạng neural network đa tầng, cũng như GMF nhóm chúng tôi cũng tạo ra 2 ma trận tiềm cho user và item.</span></p><p><span>Sau khi qua 2 ma trận tiềm ẩn thì flatten 2 ma trận này và concatenate chúng lại với nhau.</span></p><p><em><strong><span>Phần chính của MLP ở đây:</span></strong></em><br>
<span>Xây dụng 1 neural network có </span><em><strong><span>num_layer(là 1 list các số nguyên mà mỗi số ứng với số node ẩn của từng tầng trừ tâng đàu tiên ra vì đó là tống số chiều đầu ra của 2 lớp embedding ẩn )</span></strong></em><span> với hàm kích hoạt là </span><em><strong><span>relu</span></strong></em></p><p><span>Và lớp cuối cùng chắc chắn là lớp </span><em><strong><span>Dense size 1</span></strong></em><span> có giá trị đầu ra là rating được dự đoán</span></p><p><span>Cấu trúc mạng và tính toán tham số</span></p><p><img src="https://i.imgur.com/2OhHI6B.png" alt="" loading="lazy"></p><h6 id="Đánh-giá-mô-hình3" data-id="Đánh-giá-mô-hình"><a class="anchor hidden-xs" href="#Đánh-giá-mô-hình3" title="Đánh-giá-mô-hình3"><span class="octicon octicon-link"></span></a><span>Đánh giá mô hình</span></h6><ul>
<li>
<p><span>Matrix Factorization đơn giản</span></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.50272</span></td>
<td><span>0.53481</span></td>
<td><span>0.85770</span></td>
<td><span>0.63992</span></td>
<td><span>0.43130</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.55698</span></td>
<td><span>0.65482</span></td>
<td><span>0.83458</span></td>
<td><span>0.60736</span></td>
<td><span>0.40702</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><span>Mô hình MLP</span><br>
<span>Ta sẽ đánh giá mô hình khi sử dụng 1 trong 4 kernel dưới đây</span><br>
<em><strong><span>Kernels:</span></strong></em></p>
<ul>
<li>
<p><em><strong><span>Glorot-normal</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.43510</span></td>
<td><span>0.36747</span></td>
<td><span>0.894621</span></td>
<td><span>0.68207</span></td>
<td><span>0.43407</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.60170</span></td>
<td><span>0.63101</span></td>
<td><span>0.81680</span></td>
<td><span>0.53594</span></td>
<td><span>0.29844</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><em><strong><span>Glorot-uniform</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.42707</span></td>
<td><span>0.35788</span></td>
<td><span>0.89930</span></td>
<td><span>0.69496</span></td>
<td><span>0.44013</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.58926</span></td>
<td><span>0.61756</span></td>
<td><span>0.81641</span></td>
<td><span>0.53790</span></td>
<td><span>0.30312</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><em><strong><span>He-normal</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.43921</span></td>
<td><span>0.3719</span></td>
<td><span>0.89529</span></td>
<td><span>0.68197</span></td>
<td><span>0.43153</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.59377</span></td>
<td><span>0.62359</span></td>
<td><span>0.81640</span></td>
<td><span>0.53789</span></td>
<td><span>0.30313</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><em><strong><span>He-uniform</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.43018</span></td>
<td><span>0.36220</span></td>
<td><span>0.89744</span></td>
<td><span>0.69135</span></td>
<td><span>0.44374</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.58838</span></td>
<td><span>0.61102</span></td>
<td><span>0.82227</span></td>
<td><span>0.53867</span></td>
<td><span>0.30977</span></td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
</ul><p><em><strong><span>Nhận xét:</span></strong></em><span> Khi sử dụng thêm mạng neural đa tầng ta thấy ngay hiệu quả , tất cả độ đo đều tốt hơn so với mô hình </span><em><strong><span>Matrix Factorization đơn giản đã đề cập trước đó</span></strong></em><span>.</span></p><p><span>Khi sử dụng mạng neural ta đã thấy thêm tính phi tuyến nó hiệu quả như thế nào và trong bài toán của nhóm tôi, </span><em><strong><span>đối với mô hình MLP</span></strong></em><span> thì </span><em><strong><span>kernel He-uniform</span></strong></em><span> có vẻ </span><em><strong><span>hiểu quả hơn các kernel còn lại</span></strong></em></p><h5 id="Áp-dụng-cả-GMF-và-MLP" data-id="Áp-dụng-cả-GMF-và-MLP"><a class="anchor hidden-xs" href="#Áp-dụng-cả-GMF-và-MLP" title="Áp-dụng-cả-GMF-và-MLP"><span class="octicon octicon-link"></span></a><span>Áp dụng cả GMF và MLP</span></h5><h6 id="Mô-hình2" data-id="Mô-hình"><a class="anchor hidden-xs" href="#Mô-hình2" title="Mô-hình2"><span class="octicon octicon-link"></span></a><span>Mô hình</span></h6><p><span>Khi ta áp dụng của GMF và MLP mô hình sẽ có cấu trúc như sau:</span></p><p><img src="https://i.imgur.com/1Rub0MR.png" alt="" loading="lazy"></p><p><span>Do áp dụng 2 mô hình lại với nhau nên ở đầu ra của mỗi mạng sẽ có 1 ma trận , khi đó ta tiếp tục concatenate 2 matrix này và cho đi qua lớp </span><em><strong><span>Dense size 1 cuối cùng</span></strong></em><span> để đưa ra kết quả rating.</span></p><p><span>Cấu trúc mạng và tính toán tham số:</span></p><p><img src="https://i.imgur.com/gzgpZV0.png" alt="" loading="lazy"></p><h6 id="Đánh-giá-mô-hình4" data-id="Đánh-giá-mô-hình"><a class="anchor hidden-xs" href="#Đánh-giá-mô-hình4" title="Đánh-giá-mô-hình4"><span class="octicon octicon-link"></span></a><span>Đánh giá mô hình</span></h6><ul>
<li>
<p><span>Matrix Factorization đơn giản</span></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.50272</span></td>
<td><span>0.53481</span></td>
<td><span>0.85770</span></td>
<td><span>0.63992</span></td>
<td><span>0.43130</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.55698</span></td>
<td><span>0.65482</span></td>
<td><span>0.83458</span></td>
<td><span>0.60736</span></td>
<td><span>0.40702</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><span>Matrix Factorization khi áp dụng cả GMF và MLP</span></p>
<ul>
<li>
<p><em><strong><span>Glorot-normal</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.37036</span></td>
<td><span>0.37036</span></td>
<td><span>0.89627</span></td>
<td><span>0.69398</span></td>
<td><span>0.43944</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.58681</span></td>
<td><span>0.61751</span></td>
<td><span>0.82148</span></td>
<td><span>0.55195</span></td>
<td><span>0.31445</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><em><strong><span>Glorot-uniform</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.42704</span></td>
<td><span>0.36558</span></td>
<td><span>0.89695</span></td>
<td><span>0.69906</span></td>
<td><span>0.44774</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.58149</span></td>
<td><span>0.61674</span></td>
<td><span>0.82070</span></td>
<td><span>0.55313</span></td>
<td><span>0.32461</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><em><strong><span>He-normal</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.43520</span></td>
<td><span>0.37083</span></td>
<td><span>0.89402</span></td>
<td><span>0.68715</span></td>
<td><span>0.44042</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.59795</span></td>
<td><span>0.63042</span></td>
<td><span>0.81406</span></td>
<td><span>0.53789</span></td>
<td><span>0.30273</span></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><em><strong><span>He-normal</span></strong></em></p>
<table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>MAE</span></th>
<th><span>MSE</span></th>
<th><span>SIA 1</span></th>
<th><span>SIA 0.5</span></th>
<th><span>SIA 0.25</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>train</span></td>
<td><span>0.42195</span></td>
<td><span>0.35408</span></td>
<td><span>0.90076</span></td>
<td><span>0.69936</span></td>
<td><span>0.45106</span></td>
</tr>
<tr>
<td><span>test</span></td>
<td><span>0.59106</span></td>
<td><span>0.62197</span></td>
<td><span>0.82266</span></td>
<td><span>0.53984</span></td>
<td><span>0.308984</span></td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
</ul><p><em><strong><span>Nhận xét:</span></strong></em><span> Khi sử dụng cả GMF và NLP ta thấy mặc dù nó hiểu quả so với mô hình </span><em><strong><span>Matrix Factorization</span></strong></em><span> thông thường nhưng mà nó gần như xấp xỉ các độ đo so với mô hình khi chi dùng MLP. Điều này chứng minh để mô hình học tốt các đặc trưng ẩn của người dùng và phim thì mô hình nên cải thiện các tham số ở NLP vì có thêm mạng GMF thì kết quả vẫn không thay đổi nhiều.</span></p><p><span>Đặc biệt thì </span><em><strong><span>kernel Glorot-normal</span></strong></em><span> có vẻ tốt hơn trong trường hợp này so với những kernel khác</span></p><h2 id="Hệ-gợi-ý" data-id="Hệ-gợi-ý"><a class="anchor hidden-xs" href="#Hệ-gợi-ý" title="Hệ-gợi-ý"><span class="octicon octicon-link"></span></a><span>Hệ gợi ý</span></h2><h3 id="Yêu-cầu-bài-toán" data-id="Yêu-cầu-bài-toán"><a class="anchor hidden-xs" href="#Yêu-cầu-bài-toán" title="Yêu-cầu-bài-toán"><span class="octicon octicon-link"></span></a><span>Yêu cầu bài toán</span></h3><p><span>Với nhu cầu tăng lượng doanh thu cũng như khai thác tối đa các mặt hàng hiện có sao cho phù hợp với sở thích người dùng, bài toán hệ gợi ý đang được các doanh nghiệp chú trọng phát triển.</span></p><p><span>Trong đồ án môn học này, nhóm xét đến bài toán gợi ý top-k (Top-K Recommendation), với mô tả bài toán như sau: Với 1 user u và lịch sử tương tác {a, b, c,…}, cần đưa ra top k items mà user u có khả năng quan tâm nhất.</span></p><h3 id="Phương-pháp-sử-dụng" data-id="Phương-pháp-sử-dụng"><a class="anchor hidden-xs" href="#Phương-pháp-sử-dụng" title="Phương-pháp-sử-dụng"><span class="octicon octicon-link"></span></a><span>Phương pháp sử dụng</span></h3><p><span>Nhóm triển khai các mô hình gợi ý dựa trên mạng nơ-ron nhân tạo được đề xuất bởi He et al., 2017[1], bao gồm:</span></p><ul>
<li><span>Generalized Matrix Factorization (GMF)</span></li>
<li><span>Multi-Layer Perceptron (MLP)</span></li>
<li><span>Neural Matrix Factorization (NMF)</span></li>
</ul><p><span>Ý tưởng chính của các mô hình này đều dựa trên việc học ra biểu diễn ẩn của user và item thông qua các kiến trúc mạng nơ-ron, từ đó mô hình hoá được sở thích của user, cũng như tương tác giữa user và item.</span></p><p><span>(Phần lý thuyết của các mô hình này nhóm chúng tôi đã đề cập trong phần </span><em><strong><span>Áp dụng mạng neural cải thiện kết quả dự đoán rating</span></strong></em><span>)</span></p><h3 id="Chi-tiết-cài-đặt" data-id="Chi-tiết-cài-đặt"><a class="anchor hidden-xs" href="#Chi-tiết-cài-đặt" title="Chi-tiết-cài-đặt"><span class="octicon octicon-link"></span></a><span>Chi tiết cài đặt</span></h3><h4 id="Huấn-luyện" data-id="Huấn-luyện"><a class="anchor hidden-xs" href="#Huấn-luyện" title="Huấn-luyện"><span class="octicon octicon-link"></span></a><span>Huấn luyện</span></h4><p><span>Phỏng theo Quyen et al., 2021[2], nhóm thực hiện huấn luyện với phương pháp negative sampling, trong đó tỉ lệ negative/positive = 4</span><br>
<span>Hàm lỗi sử dụng ở đây là Cross Entropy.</span></p><h4 id="Xử-lý-dữ-liệu" data-id="Xử-lý-dữ-liệu"><a class="anchor hidden-xs" href="#Xử-lý-dữ-liệu" title="Xử-lý-dữ-liệu"><span class="octicon octicon-link"></span></a><span>Xử lý dữ liệu</span></h4><p><span>Với tập dữ liệu rating ban đầu thu được từ trang thương mại Tiki, nhóm thực hiện loại bỏ các user với lịch sử tương tác ít hơn 10. Thống kê chung về tập dữ liệu được trình bày trong bảng sau:</span></p><table>
<thead>
<tr>
<th><span>Dataset</span></th>
<th><span>Tiki-Ecommerce</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>Explicit</span></td>
<td><span>56480</span></td>
</tr>
<tr>
<td><span>Users</span></td>
<td><span>3450</span></td>
</tr>
<tr>
<td><span>Items</span></td>
<td><span>11312</span></td>
</tr>
<tr>
<td><span>Sparisity</span></td>
<td><span>99.85%</span></td>
</tr>
</tbody>
</table><p><em><strong><span>Xử lý:</span></strong></em></p><p><span>Dựa trên phân bố rating, có thể thấy phần đa các rating thuộc vào đoạn 4-5 (chiếm gần 80%) dẫn đến việc mất cân bằng dữ liệu nghiêm trọng khi sử dụng dữ liệu tường minh (explicit). Do đó, nhóm lựa chọn chỉ sử dụng dữ liệu tiềm ẩn (implicit), trong đó một cặp user-item sẽ được gán nhãn có tương tác (1-positive) nếu tồn tại rating và không tương tác (0-negative) nếu không tồn tại rating tương ứng</span></p><h4 id="Đánh-giá" data-id="Đánh-giá"><a class="anchor hidden-xs" href="#Đánh-giá" title="Đánh-giá"><span class="octicon octicon-link"></span></a><span>Đánh giá:</span></h4><p><span>Nhóm thực hiện đánh giá theo chiến lược leave-one-out. Item cuối trong chuỗi tương tác được dùng để đánh giá, các item còn lại dùng để huấn luyện. Sau cùng, mỗi ground-truth item (item cuối) được trộn với 99 negative items. Bài toán trở về việc xếp hạng 100 items và đánh giá theo thứ tự xếp hạng của ground-truth item.</span></p><p><span>Trong đây, nhóm sử dụng 2 độ đo phổ biến là </span><em><strong><span>Hit Ratio (HR@K)</span></strong></em><span> và </span><em><strong><span>Normalized Discounted Cumulative Count (nDCG)</span></strong></em><span>.</span></p><p><em><strong><span>Hit Ratio</span></strong></em><span> là độ đo phản ánh dựa trên việc item cuối có nằm trong top K item gợi ý ra bởi hệ thống gợi ý hay không.</span><br>
<img src="https://i.imgur.com/I6dXJ7f.png" alt="" loading="lazy"></p><p><span>Mặt khác, </span><em><strong><span>nDCG</span></strong></em><span> đánh trọng số cao hơn cho các hệ thống gợi ý trong đó item cuối (ground-truth item) được xếp hạng cao hơn các item khác, khi nằm trong top K item được gợi ý ra.</span></p><p><img src="https://i.imgur.com/KZvLGXW.png" alt="" loading="lazy"></p><h4 id="Thông-số-cài-đặt" data-id="Thông-số-cài-đặt"><a class="anchor hidden-xs" href="#Thông-số-cài-đặt" title="Thông-số-cài-đặt"><span class="octicon octicon-link"></span></a><span>Thông số cài đặt</span></h4><p><span>Nhóm thử nghiệm với các thông số cài đặt sau:</span><br>
<span>Giải thuật học: Adam (β_1=0.9, β_2=0.999)</span></p><ul>
<li><span>Eta = {10, 1, 1e-1, 1e-2, 1e-3, 1e-4, 1e-5, 1e-6}</span></li>
<li><span>Latent Size = {4, 8, 16, 32, 64}</span></li>
<li><span>Batch Size = 512</span></li>
<li><span>Negative Sampling Ratio = 4</span></li>
</ul><p><span>Kết quả tuning tham số chỉ ra các bộ tham số phù hợp với từng mô hình </span><em><strong><span>(Eta, Latent Size)</span></strong></em><span>:</span></p><ul>
<li><span>GMF: Eta = 1e-1, Latent Size = 8</span></li>
<li><span>MLP: Eta = 1e-2, Latent Size = 32</span></li>
<li><span>NMF: Eta = 1e-2, Latent Size = 16</span></li>
</ul><h4 id="Thử-nghiệm" data-id="Thử-nghiệm"><a class="anchor hidden-xs" href="#Thử-nghiệm" title="Thử-nghiệm"><span class="octicon octicon-link"></span></a><span>Thử nghiệm</span></h4><h5 id="Eta" data-id="Eta"><a class="anchor hidden-xs" href="#Eta" title="Eta"><span class="octicon octicon-link"></span></a><span>Eta</span></h5><p><img src="https://i.imgur.com/9PUO7OE.png" alt="" loading="lazy"></p><p><em><strong><span>Nhận xét:</span></strong></em></p><p><span>Nhóm thực hiện tuning tham số Eta (tốc độ học, hay learning rate), sử dụng item kề cuối làm đánh giá (validation). Từ trên đồ thị dễ thấy với cả ba mô hình, giá trị Eta hoặc quá lớn (10, 1) hoặc quá nhỏ (1e-5, 1e-6) khiến quá trình học không ổn định, hoặc quá chậm, dẫn đến kết quả chỉ ra không tốt. Với GMF, giá trị Eta tốt nhất là 1e-1, trong khi với MLP và NMF, giá trị này là 1e-2.</span></p><h5 id="Latent-Size" data-id="Latent-Size"><a class="anchor hidden-xs" href="#Latent-Size" title="Latent-Size"><span class="octicon octicon-link"></span></a><span>Latent Size</span></h5><p><img src="https://i.imgur.com/tkxfcq9.png" alt="" loading="lazy"></p><p><em><strong><span>Nhận xét:</span></strong></em></p><p><span>Thực hiện tuning tương tự, ta thu được biểu đồ như trên với Latent Size (kích thước vectơ embedding của user và item trong mỗi mô hình).</span><br>
<span>Từ trên biểu đồ, có vẻ Latent Size ở mức 16 và 32 cho kết quả ổn nhất cho cả 3 mô hình. Tuy nhiên kết quả chi tiết trên tập test (trình bày ngay sau đây) cho thấy cần thực hiện tuning sát sao hơn.</span></p><h5 id="Quá-trình-chạy-với-50-epochs" data-id="Quá-trình-chạy-với-50-epochs"><a class="anchor hidden-xs" href="#Quá-trình-chạy-với-50-epochs" title="Quá-trình-chạy-với-50-epochs"><span class="octicon octicon-link"></span></a><span>Quá trình chạy với 50 epochs</span></h5><p><img src="https://i.imgur.com/KABbZss.png" alt="" loading="lazy"></p><p><em><strong><span>Nhận xét:</span></strong></em></p><p><span>Với Latent Size (K) = 8, cả 3 mô hình đều cho thấy quá trình học ổn định. Về Hit Ratio, MLP cho kết quả nhỉnh hơn NMF, và thấp nhất là GMF. Về nDCG, trái lại, NMF cho kết quả tốt nhất, trong khi MLP thấp hơn, còn GMF ngang ngửa MLP. Như vậy, với K=8, NMF cho thấy khả năng mô hình hoá cặn kẽ hơn, tức các item liên quan khi được tìm thấy, có xu hướng được xếp hạng cao hơn, biểu thị sự mô hình hoá chi tiết hơn về sở thích người dùng, tuy không bao quát bằng MLP (các item liên quan được tìm thấy nhiều hơn, nhưng xu hướng xếp hạng không cao). GMF cũng cho thấy biểu hiện tương tự với K=8.</span></p><p><img src="https://i.imgur.com/zvp7rqv.png" alt="" loading="lazy"></p><p><em><strong><span>Nhận xét:</span></strong></em></p><p><span>Với K=16, MLP tiếp tục đạt kết quả tốt nhất về khía cạnh Hit Ratio, tuy nhiên vẫn thấp hơn chút so với NMF về nDCG. GMF cho kết quả hơi thấp hơn với K=8, đồng thời chênh lệch đáng kể với NMF và MLP.</span></p><p><img src="https://i.imgur.com/CLSwPz4.png" alt="" loading="lazy"></p><p><em><strong><span>Nhận xét:</span></strong></em></p><p><span>Với K=32, quá trình học của GMF trở nên bất ổn định, điều này biểu thị rõ ràng trên đồ thị, khi mà kết quả dao động liên tục ở cả hai độ đo. Như vậy, GMF không hoạt động tốt với K=32, và nhìn chung, kết quả cũng không cao với K=16, khi so với K=8. Trái lại, MLP vẫn cho kết quả tốt, thậm chí nhỉnh hơn một chút, so với K=16. NMF có kết quả thấp hơn, thậm chí chêch lệnh lớn với MLP theo Hit Ratio và chỉ ngang bằng với MLP theo nDCG. Ở giai đoạn giữa thậm chí NMF bị MLP vượt lên trước với nDCG.</span></p><p><em><strong><span>Qua đây, có thể thấy được, các giá trị Latent Size tốt nhất với GMF, MLP, NMF lần lượt là 8, 32, 16.</span></strong></em></p><h5 id="Negative-Sampling" data-id="Negative-Sampling"><a class="anchor hidden-xs" href="#Negative-Sampling" title="Negative-Sampling"><span class="octicon octicon-link"></span></a><span>Negative Sampling</span></h5><p><img src="https://i.imgur.com/toUyX3w.png" alt="" loading="lazy"></p><p><em><strong><span>Nhận xét:</span></strong></em></p><p><span>Tuy nhóm không thực hiện tuning với Negative Sampling Ratio, một thí nghiệm nhỏ khác chứng minh hiệu quả của việc dùng Negative Sampling so với chỉ huấn luyện thông thường.</span><br>
<span>Cả 3 mô hình được huấn luyện và kiểm thử trên tập test sau 10 epochs, ký hiệu 0- đối với huấn luyện thường và 4- với việc dùng Negative Sampling (ratio = 4). Đồ thị biểu hiễn rõ ràng khi dùng Negative Sampling, kết quả của các mô hình được cải thiện đáng kể.</span></p><h5 id="Top-K" data-id="Top-K"><a class="anchor hidden-xs" href="#Top-K" title="Top-K"><span class="octicon octicon-link"></span></a><span>Top-K</span></h5><p><img src="https://i.imgur.com/O4d4AD0.png" alt="" loading="lazy"></p><p><em><strong><span>Nhận xét:</span></strong></em></p><p><span>Ở phần chạy thử với 50 epochs, ta thấy được NMF có xu hướng cho giá trị nDCG tốt hơn MLP, tuy hơi thấp hơn về Hit Ratio. Ở đây thực hiện một thử nghiệm khác, với số epochs ít hơn để tiết kiệm thời gian, khi cho K (Top-K) thay đổi từ 1-10, ta thu được đồ thị như hình. Dễ thấy với K thấp, thì Hit Ratio của NMF cao hơn hẳn MLP, tương tự GMF cũng cao hơn (K=1, 2) nhưng khi K tăng thì MLP lại vượt lên, tuy ở đây vẫn giữ ngang mức với NMF chứ chưa vượt hẳn như thí nghiệm trên. Song, chỉ từ Hit Ratio, ta lý giải được tại sao NMF cho giá trị nDCG cao hơn hẳn MLP ở đồ thị con bên phải, từ đó có một góc nhìn thú vị.</span></p><h5 id="Đánh-giá-sau-cùng" data-id="Đánh-giá-sau-cùng"><a class="anchor hidden-xs" href="#Đánh-giá-sau-cùng" title="Đánh-giá-sau-cùng"><span class="octicon octicon-link"></span></a><span>Đánh giá sau cùng:</span></h5><p><img src="https://i.imgur.com/Kcj5gGW.png" alt="" loading="lazy"></p><p><em><strong><span>Nhận xét:</span></strong></em></p><p><span>Về kết quả cuối trên tập test, MLP cho kết quả cao nhất với HR@10, trong khi NMF-Pretrain (khởi tạo trọng số từ weight của MLP và GMF) cho kết quả tốt nhất với nDCG@10, tuy không cải thiện nhiều với NMF. GMF đạt kết quả thấp nhất, có thể do kiến trúc đơn giản nhất trong các mô hình trên, do đó chưa mô hình hoá được tốt biểu diễn của người dùng. NMF tuy thấp hơn MLP về HR@10, nhưng cho kết quả cao hơn về nDCG@10.</span></p><h4 id="Một-vài-case-study" data-id="Một-vài-case-study"><a class="anchor hidden-xs" href="#Một-vài-case-study" title="Một-vài-case-study"><span class="octicon octicon-link"></span></a><span>Một vài case study</span></h4><ul>
<li><span>Case study 1:</span></li>
</ul><p><img src="https://i.imgur.com/sNsvmTE.png" alt="" loading="lazy"></p><p><span>Nhìn chung, người dùng này có sở thích với đồ gia dụng và bách hoá, chăm sóc sức khoẻ và làm đẹp. Một số sản phẩm kể đến như máy xay thịt, tông đơ, đồ ăn (khô gà, mực sợi), vật phẩm dưỡng da (tinh chất dưỡng ẩm, sữa rửa mặt, kem dưỡng ẩm). Đây là một người dùng có sở thích khá đa dạng</span></p><p><img src="https://i.imgur.com/edzyGzS.png" alt="" loading="lazy"></p><p><span>Với GMF, về khía cạnh thể loại, đã gợi ý ra một vài sản phẩm khá hợp lý, như sữa đậu nành (người dùng có mua sữa chua), bắp giò heo, cơm cháy (đồ ăn), dầu gội (liên hệ với tông đơ), đèn bàn học (liên hệ với do-choi-me-be). Tuy nhiên, một số sản phẩm còn chưa hợp lý, như gợi ý TP-Link, hay Cát Vệ Sinh cho Mèo (dù cùng thể loại bách hoá nhưng không gần với sở thích người dùng).</span></p><p><img src="https://i.imgur.com/out3UY3.png" alt="" loading="lazy"></p><p><span>Bên cạnh các gợi ý tốt (chanh, đèn bàn học, kem chống nắng, tất nữ, bông trang điểm), thì MLP cũng có những gợi ý chưa hợp lý như cảm biến áp suất oto, hay áo bóng đá (người dùng có sở thích với fitness, chứ chưa hẳn là với bóng đá)</span></p><p><img src="https://i.imgur.com/loEMjDM.png" alt="" loading="lazy"></p><p><span>Được cho là kết hợp của cả 2, NMF cũng có những kết quả hợp lý (nồi chiên không dầu, sữa đậu nành, sữa bột, yến mạch, đồ chơi lắp ráp, kem chống nắng) và chưa hợp lý (USB, Ví nam da bò, đồng hồ nam).</span></p><ul>
<li><span>Case study 2:</span></li>
</ul><p><img src="https://i.imgur.com/ODaH331.png" alt="" loading="lazy"></p><p><span>Case Study 2 thuộc về một người dùng có sở thích nội trợ, toàn bộ đều là về thực phẩm</span></p><p><img src="https://i.imgur.com/1szXEiz.png" alt="" loading="lazy"></p><p><span>Kết quả gợi ý của GMF khá tệ, ngoại trừ trà oolong có một ít liên quan, còn lại đều là các vật phẩm không liên hệ với sở thích người dùng.</span></p><p><img src="https://i.imgur.com/kyN9heD.png" alt="" loading="lazy"></p><p><span>Kết quả của MLP có một chút trùng với GMF, nhưng đã tốt hơn với các gợi ý hợp lý như tỏi, chả giò.</span><br>
<img src="https://i.imgur.com/osP8RXi.png" alt="" loading="lazy"></p><p><span>NMF cũng có hai kết quả liên quan (Bánh bột lọc, cam sành), nhưng còn lại thì chưa hợp lý.</span></p><ul>
<li><span>Case study 3:</span></li>
</ul><p><img src="https://i.imgur.com/3mlZLss.png" alt="" loading="lazy"></p><p><span>Case Study cuối thuộc về một người dùng nữ, có sở thích về thời trang, làm đẹp, và nội trợ chung (quan tâm về máy giặt, nồi chảo).</span></p><p><img src="https://i.imgur.com/IYaVsN1.png" alt="" loading="lazy"></p><p><span>GMF gợi ý ra một vài kết quả hợp lý (Kem dưỡng giảm mụn, giày vải nữ, mặt dây chuyền), nhưng phần đa vẫn là các gợi ý không liên quan.</span></p><p><img src="https://i.imgur.com/1sgGcWT.png" alt="" loading="lazy"></p><p><span>Với MLP, hầu hết vẫn là các kết quả gợi ý không liên quan, ngoại trừ áo thun.</span></p><p><img src="https://i.imgur.com/LtK50a3.png" alt="" loading="lazy"></p><p><span>Với NMF, kết quả khá khẩm hơn chút khi gợi ý ra được dụng cụ cho nội trợ, việc nhà như cây lau nhà, dép đi trong  nhà, nước rửa tay hay kệ chén bát, bên cạnh áo thun. Tuy nhiên, các kết quả khác như dây mạng, quần lót nam, vốn không liên hệ đến lịch sử người dùng, biểu thị chúng ta cần xây dựng hệ gợi ý phù hợp hơn và cải tiến nhiều hơn, trước khi cài đặt trong hệ thống thực.</span></p></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li><a href="#Báo-cáo-đồ-án-môn-khoa-học-dữ-liệu" title="Báo cáo đồ án môn khoa học dữ liệu">Báo cáo đồ án môn khoa học dữ liệu</a><ul class="nav">
<li><a href="#Tự-đánh-giá-project" title="Tự đánh giá project">Tự đánh giá project</a></li>
<li><a href="#Về-chúng-tôi" title="Về chúng tôi">Về chúng tôi</a><ul class="nav">
<li><a href="#Thành-viên-nhóm" title="Thành viên nhóm">Thành viên nhóm</a></li>
<li><a href="#Phân-công-công-việc" title="Phân công công việc">Phân công công việc</a></li>
</ul>
</li>
<li><a href="#Đề-tài" title="Đề tài">Đề tài</a></li>
<li><a href="#Thu-thập-dữ-liệu" title="Thu thập dữ liệu:">Thu thập dữ liệu:</a></li>
<li><a href="#Tích-hợp-dữ-liệu" title="Tích hợp dữ liệu">Tích hợp dữ liệu</a></li>
<li><a href="#Làm-sạch-và-tiền-xử-lý-dữ-liệu" title="Làm sạch và tiền xử lý dữ liệu">Làm sạch và tiền xử lý dữ liệu</a></li>
<li><a href="#TIKI-datasets" title="TIKI datasets">TIKI datasets</a></li>
<li><a href="#Khám-phá-dữ-liệu" title="Khám phá dữ liệu">Khám phá dữ liệu</a></li>
<li><a href="#Một-số-khái-niệm-và-độ-đo-cần-thiết-trong-project" title="Một số khái niệm và độ đo cần thiết trong project">Một số khái niệm và độ đo cần thiết trong project</a><ul class="nav">
<li><a href="#SIA---Soft-Interval-Accuracy" title="SIA - Soft Interval Accuracy">SIA - Soft Interval Accuracy</a></li>
<li><a href="#MAE---Mean-Absolute-Error" title="MAE - Mean Absolute Error">MAE - Mean Absolute Error</a></li>
<li><a href="#MSE---Mean-Squared-Error" title="MSE - Mean Squared Error">MSE - Mean Squared Error</a></li>
<li><a href="#RMSE---Root-Mean-Squared-Error" title="RMSE - Root Mean Squared Error">RMSE - Root Mean Squared Error</a></li>
<li><a href="#Confusion-Matrix" title="Confusion Matrix">Confusion Matrix</a></li>
<li><a href="#Precision-và-Recall" title="Precision và Recall">Precision và Recall</a></li>
</ul>
</li>
<li><a href="#Sold-Prediction-And-User-Behaviour-Based-On-Item’s-Features" title="Sold Prediction And User Behaviour Based On Item’s Features">Sold Prediction And User Behaviour Based On Item’s Features</a><ul class="nav">
<li><a href="#Random-Forest-Regression" title="Random Forest Regression">Random Forest Regression</a></li>
<li><a href="#Linear-Regression" title="Linear Regression">Linear Regression</a></li>
<li><a href="#Neural-Network" title="Neural Network">Neural Network</a></li>
</ul>
</li>
<li><a href="#Rating-Prediction" title="Rating Prediction">Rating Prediction</a><ul class="nav">
<li><a href="#Phương-pháp-phân-rã-ma-trận-matrix-factorization" title="Phương pháp phân rã ma trận matrix factorization">Phương pháp phân rã ma trận matrix factorization</a></li>
<li><a href="#Phương-pháp-gợi-ý-dựa-trên-nội-dung-content-based" title="Phương pháp gợi ý dựa trên nội dung content-based">Phương pháp gợi ý dựa trên nội dung content-based</a></li>
<li><a href="#Ứng-dụng-1-số-neural-network-đơn-giản-cho-bài-toán-rating-prediction" title="Ứng dụng 1 số neural network đơn giản cho bài toán rating prediction">Ứng dụng 1 số neural network đơn giản cho bài toán rating prediction</a></li>
</ul>
</li>
<li><a href="#Hệ-gợi-ý" title="Hệ gợi ý">Hệ gợi ý</a><ul class="nav">
<li><a href="#Yêu-cầu-bài-toán" title="Yêu cầu bài toán">Yêu cầu bài toán</a></li>
<li><a href="#Phương-pháp-sử-dụng" title="Phương pháp sử dụng">Phương pháp sử dụng</a></li>
<li><a href="#Chi-tiết-cài-đặt" title="Chi tiết cài đặt">Chi tiết cài đặt</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null null>
        <div class="toc"><ul class="nav">
<li><a href="#Báo-cáo-đồ-án-môn-khoa-học-dữ-liệu" title="Báo cáo đồ án môn khoa học dữ liệu">Báo cáo đồ án môn khoa học dữ liệu</a><ul class="nav">
<li><a href="#Tự-đánh-giá-project" title="Tự đánh giá project">Tự đánh giá project</a></li>
<li><a href="#Về-chúng-tôi" title="Về chúng tôi">Về chúng tôi</a><ul class="nav">
<li><a href="#Thành-viên-nhóm" title="Thành viên nhóm">Thành viên nhóm</a></li>
<li><a href="#Phân-công-công-việc" title="Phân công công việc">Phân công công việc</a></li>
</ul>
</li>
<li><a href="#Đề-tài" title="Đề tài">Đề tài</a></li>
<li><a href="#Thu-thập-dữ-liệu" title="Thu thập dữ liệu:">Thu thập dữ liệu:</a></li>
<li><a href="#Tích-hợp-dữ-liệu" title="Tích hợp dữ liệu">Tích hợp dữ liệu</a></li>
<li><a href="#Làm-sạch-và-tiền-xử-lý-dữ-liệu" title="Làm sạch và tiền xử lý dữ liệu">Làm sạch và tiền xử lý dữ liệu</a></li>
<li><a href="#TIKI-datasets" title="TIKI datasets">TIKI datasets</a></li>
<li><a href="#Khám-phá-dữ-liệu" title="Khám phá dữ liệu">Khám phá dữ liệu</a></li>
<li><a href="#Một-số-khái-niệm-và-độ-đo-cần-thiết-trong-project" title="Một số khái niệm và độ đo cần thiết trong project">Một số khái niệm và độ đo cần thiết trong project</a><ul class="nav">
<li><a href="#SIA---Soft-Interval-Accuracy" title="SIA - Soft Interval Accuracy">SIA - Soft Interval Accuracy</a></li>
<li><a href="#MAE---Mean-Absolute-Error" title="MAE - Mean Absolute Error">MAE - Mean Absolute Error</a></li>
<li><a href="#MSE---Mean-Squared-Error" title="MSE - Mean Squared Error">MSE - Mean Squared Error</a></li>
<li><a href="#RMSE---Root-Mean-Squared-Error" title="RMSE - Root Mean Squared Error">RMSE - Root Mean Squared Error</a></li>
<li><a href="#Confusion-Matrix" title="Confusion Matrix">Confusion Matrix</a></li>
<li><a href="#Precision-và-Recall" title="Precision và Recall">Precision và Recall</a></li>
</ul>
</li>
<li><a href="#Sold-Prediction-And-User-Behaviour-Based-On-Item’s-Features" title="Sold Prediction And User Behaviour Based On Item’s Features">Sold Prediction And User Behaviour Based On Item’s Features</a><ul class="nav">
<li><a href="#Random-Forest-Regression" title="Random Forest Regression">Random Forest Regression</a></li>
<li><a href="#Linear-Regression" title="Linear Regression">Linear Regression</a></li>
<li><a href="#Neural-Network" title="Neural Network">Neural Network</a></li>
</ul>
</li>
<li><a href="#Rating-Prediction" title="Rating Prediction">Rating Prediction</a><ul class="nav">
<li><a href="#Phương-pháp-phân-rã-ma-trận-matrix-factorization" title="Phương pháp phân rã ma trận matrix factorization">Phương pháp phân rã ma trận matrix factorization</a></li>
<li><a href="#Phương-pháp-gợi-ý-dựa-trên-nội-dung-content-based" title="Phương pháp gợi ý dựa trên nội dung content-based">Phương pháp gợi ý dựa trên nội dung content-based</a></li>
<li><a href="#Ứng-dụng-1-số-neural-network-đơn-giản-cho-bài-toán-rating-prediction" title="Ứng dụng 1 số neural network đơn giản cho bài toán rating prediction">Ứng dụng 1 số neural network đơn giản cho bài toán rating prediction</a></li>
</ul>
</li>
<li><a href="#Hệ-gợi-ý" title="Hệ gợi ý">Hệ gợi ý</a><ul class="nav">
<li><a href="#Yêu-cầu-bài-toán" title="Yêu cầu bài toán">Yêu cầu bài toán</a></li>
<li><a href="#Phương-pháp-sử-dụng" title="Phương pháp sử dụng">Phương pháp sử dụng</a></li>
<li><a href="#Chi-tiết-cài-đặt" title="Chi tiết cài đặt">Chi tiết cài đặt</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
